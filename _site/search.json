[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS626-GAA",
    "section": "",
    "text": "Welcome to Brigitta Karen Tsai’s webpage. In this webpage, you will find the documentation of my learning journey for Geospatial Analytics and Application course!"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "In this analysis, we are interested to discover:\n\nIf the key indicators of tourism economy of Thailand are independent from space and time\n\n\n\n\n\n\n\n\npacman::p_load(sf, spdep, tmap, tidyverse, knitr, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, GGally, GWmodel,\n               ggstatsplot, Kendall, plotly, sfdep)\n\n\n\n\n\nAspatial DataGeospatial Data\n\n\n\ntourism &lt;- read_csv(\"data/aspatial/thailand_domestic_tourism_2019_2023_ver2.csv\") %&gt;% \n  mutate(year = year(date))\n\nRows: 30800 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): province_thai, province_eng, region_thai, region_eng, variable\ndbl  (1): value\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nboundary &lt;- st_read(dsn = \"data/geospatial\",\n                        layer = \"tha_admbnda_adm1_rtsd_20220121\") %&gt;% \n  st_transform(crs = 32647)\n\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\brigittatsai\\ISSS626_AY2024-25_T1\\Take-home_Ex\\Take-home_Ex02\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\n\n\n\n\n\n\nboundary &lt;- boundary %&gt;%\n  rename(province_eng = ADM1_EN)\n\n\nboundary &lt;- boundary[, !(names(boundary) %in% c(\"ADM3_REF\", \"ADM3ALT1EN\", \"ADM3ALT2EN\", \"ADM3ALT1TH\", \"ADM3ALT2TH\", \"ADM3_TH\",\"ADM2_TH\", \"ADM1_TH\", \"ADM0_TH\", \"ADM0_EN\", \"ADM0_PCODE\", \"ADM3_PCODE\", \"ADM2_PCODE\", \"validOn\", \"validTo\", \"ADM1_PCODE\", \"date\", \"ADM1_REF\", \"ADM1ALT1EN\", \"ADM1ALT2EN\", \"ADM1ALT1TH\", \"ADM1ALT2TH\"))]\n\n\nboundary[is.na(boundary$Shape_Leng), ]\n\nSimple feature collection with 0 features and 3 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: WGS 84 / UTM zone 47N\n[1] Shape_Leng   Shape_Area   province_eng geometry    \n&lt;0 rows&gt; (or 0-length row.names)\n\n\n\n\n\n\ntourism &lt;- tourism[, !(names(tourism) %in% c(\"province_thai\", \"region_thai\"))]\n\n\nunique(tourism$variable)\n\n[1] \"ratio_tourist_stay\" \"no_tourist_stay\"    \"no_tourist_all\"    \n[4] \"no_tourist_thai\"    \"no_tourist_foreign\" \"revenue_all\"       \n[7] \"revenue_thai\"       \"revenue_foreign\"   \n\n\n\noptions(scipen = 999) # to display full number when summing up the value column\n\nRevenue generated by tourism industry\n\nrevenue_all &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"revenue_all\"))\n\n\nrevenue_all &lt;- revenue_all %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nrevenue_all &lt;- revenue_all %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nRevenue generated by Thai tourists\n\nrevenue_thai &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"revenue_thai\"))\n\n\nrevenue_thai &lt;- revenue_thai %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nrevenue_thai &lt;- revenue_thai %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nRevenue generated by foreign tourists\n\nrevenue_foreign &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"revenue_foreign\"))\n\n\nrevenue_foreign &lt;- revenue_foreign %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nrevenue_foreign &lt;- revenue_foreign %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of tourists who stay overnight\n\ntourist_stay &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_stay\"))\n\n\ntourist_stay &lt;- tourist_stay %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_stay &lt;- tourist_stay %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of domestic tourists who visited the province\n\ntourist_all &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_all\"))\n\n\ntourist_all &lt;- tourist_all %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_all &lt;- tourist_all %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of Thai tourists who visited the province\n\ntourist_thai &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_thai\"))\n\n\ntourist_thai &lt;- tourist_thai %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_thai &lt;- tourist_thai %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of foreign tourists who visited the province\n\ntourist_foreign &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_foreign\"))\n\n\ntourist_foreign &lt;- tourist_foreign %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_foreign &lt;- tourist_foreign %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nRatio of tourist stay overnight\nRatio = Total rooms booked/ total available rooms\n\nratio_tourist &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"ratio_tourist_stay\"))\n\nFor this column, we will use median to aggregate the values as it is not appropriate to sum ratio values\n\nratio_tourist &lt;- ratio_tourist %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = median(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nratio_tourist &lt;- ratio_tourist %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\n\n\n\n\n\nAs seen in previous section, the tourism dataset is divided into each variables to sum the values. Let’s first join the tourism dataset into 1 again.\n\ntourism_data &lt;- revenue_all %&gt;%\n  left_join(revenue_thai, by = \"province_eng\") %&gt;%\n  left_join(revenue_foreign, by = \"province_eng\") %&gt;%\n  left_join(tourist_stay, by = \"province_eng\") %&gt;% \n  left_join(tourist_all, by = \"province_eng\") %&gt;% \n  left_join(tourist_thai, by = \"province_eng\") %&gt;% \n  left_join(tourist_foreign, by = \"province_eng\") %&gt;% \n  left_join(ratio_tourist, by = \"province_eng\")\n\n\n\n\nNow, let us join both boundary and tourism data\n\nthai_tourism &lt;- left_join(boundary, tourism_data, by = c(\"province_eng\"))\n\nLet us check if there is unmatched rows to ensure data is accurate\n\nunmatched &lt;- thai_tourism %&gt;% \n  filter(is.na(Shape_Leng))\n\nprint(unmatched)\n\nSimple feature collection with 0 features and 11 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: WGS 84 / UTM zone 47N\n [1] Shape_Leng         Shape_Area         province_eng       revenue_all       \n [5] revenue_thai       revenue_foreign    no_tourist_stay    no_tourist_all    \n [9] no_tourist_thai    no_tourist_foreign ratio_tourist_stay geometry          \n&lt;0 rows&gt; (or 0-length row.names)\n\n\nThere are multiple missing values after joining the table. This is due to different spacings of province name. Let us check using the code below\n\ncheck_value &lt;- tourism %&gt;%\n  filter(province_eng %in% c(\"Buriram\", \"Chainat\", \"Chonburi\", \"Lopburi\", \"Nong Bua Lamphu\", \"Phang Nga\", \"Prachinburi\", \"Sisaket\"))\n\nprint(check_value)\n\n# A tibble: 3,200 × 6\n   date       province_eng    region_eng     variable           value  year\n   &lt;date&gt;     &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;\n 1 2019-01-01 Lopburi         central        ratio_tourist_stay  61.3  2019\n 2 2019-01-01 Chainat         central        ratio_tourist_stay  79.3  2019\n 3 2019-01-01 Chonburi        east           ratio_tourist_stay  84.3  2019\n 4 2019-01-01 Prachinburi     east           ratio_tourist_stay  68.6  2019\n 5 2019-01-01 Phang Nga       south          ratio_tourist_stay  86.5  2019\n 6 2019-01-01 Buriram         east_northeast ratio_tourist_stay  71.3  2019\n 7 2019-01-01 Sisaket         south          ratio_tourist_stay  68.6  2019\n 8 2019-01-01 Nong Bua Lamphu east_northeast ratio_tourist_stay  65.0  2019\n 9 2020-01-01 Lopburi         central        ratio_tourist_stay  51.5  2020\n10 2020-01-01 Chainat         central        ratio_tourist_stay  73.5  2020\n# ℹ 3,190 more rows\n\n\n\ncheck_value2 &lt;- boundary %&gt;%\n  filter(province_eng %in% c(\"Buri Ram\", \"Chai Nat\", \"Chon Buri\", \"Lop Buri\", \"Nong Bua Lam Phu\", \"Phangnga\", \"Prachin Buri\", \"Si Sa Ket\"))\n\nprint(check_value2)\n\nSimple feature collection with 8 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 349324.1 ymin: 856050.4 xmax: 1137931 ymax: 1959175\nProjected CRS: WGS 84 / UTM zone 47N\n  Shape_Leng Shape_Area     province_eng                       geometry\n1   5.693342  0.5457884         Lop Buri MULTIPOLYGON (((751293.3 17...\n2   2.896316  0.2090783         Chai Nat MULTIPOLYGON (((620165.4 17...\n3   6.091786  0.3756301        Chon Buri MULTIPOLYGON (((714273.8 13...\n4   4.705205  0.4223316     Prachin Buri MULTIPOLYGON (((768228.7 15...\n5   8.701860  0.8445370         Buri Ram MULTIPOLYGON (((921217 1750...\n6   6.354893  0.7461402        Si Sa Ket MULTIPOLYGON (((1047999 172...\n7   4.478819  0.3451953 Nong Bua Lam Phu MULTIPOLYGON (((848689.2 19...\n8   9.158469  0.3364923         Phangnga MULTIPOLYGON (((457515.4 85...\n\n\nNotice that the writings are inconsistent. Let us standardize it by changing the name in the boundary data\n\nboundary &lt;- boundary %&gt;%\n  mutate(province_eng = recode(province_eng,\n                          \"Buri Ram\" = \"Buriram\",\n                          \"Chai Nat\" = \"Chainat\",\n                          \"Chon Buri\" = \"Chonburi\",\n                          \"Nong Bua Lam Phu\" = \"Nong Bua Lamphu\",\n                          \"Phangnga\" = \"Phang Nga\",\n                          \"Prachin Buri\" = \"Prachinburi\",\n                          \"Si Sa Ket\" = \"Sisaket\",\n                          \"Lop Buri\" = \"Lopburi\"))\n\nLet us join the table again\n\nthai_tourism &lt;- left_join(boundary, tourism_data, by = c(\"province_eng\"))\n\nLet us do final check if there is any missing value\n\nmissing &lt;- thai_tourism %&gt;% \n  filter(is.na(Shape_Leng))\n\nprint(missing)\n\nSimple feature collection with 0 features and 11 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: WGS 84 / UTM zone 47N\n [1] Shape_Leng         Shape_Area         province_eng       revenue_all       \n [5] revenue_thai       revenue_foreign    no_tourist_stay    no_tourist_all    \n [9] no_tourist_thai    no_tourist_foreign ratio_tourist_stay geometry          \n&lt;0 rows&gt; (or 0-length row.names)\n\n\nThere is no missing value in the final dataset. The dataset is ready to be used for analysis\n\n\n\n\nLet us create a time series cube based on the revenue generated from tourism in Thailand\n\ntourism_revenue &lt;- tourism %&gt;%\n  filter(variable %in% c(\"revenue_all\"))\n\nDerive a dataframe grouped by the year and province in Thailand\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  group_by(year, province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n\n\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\n\ntourism_st &lt;- spacetime(tourism_revenue, boundary,\n                      .loc_col = \"province_eng\",\n                      .time_col = \"year\")\n\n\nis_spacetime_cube(tourism_st)\n\n[1] TRUE\n\n\n\n\n\n\n\n\n\nclass(thai_tourism)\n\n[1] \"sf\"         \"data.frame\"\n\n\n\nbasemap &lt;- tm_shape(thai_tourism) +\n  tm_polygons() +\n  tm_text(\"province_eng\", size=0.5)\n\ngdppc &lt;- qtm(thai_tourism, \"revenue_all\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\nSome legend labels were too wide. These labels have been resized to 0.64, 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\nbasemap &lt;- tm_shape(thai_tourism) +\n  tm_polygons() +\n  tm_text(\"province_eng\", size=0.5)\n\ngdppc &lt;- qtm(thai_tourism, \"no_tourist_thai\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nbasemap &lt;- tm_shape(thai_tourism) +\n  tm_polygons() +\n  tm_text(\"province_eng\", size=0.5)\n\ngdppc &lt;- qtm(thai_tourism, \"no_tourist_foreign\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\nFindings:\nFrom the choropleth map, we can roughly see that most foreign tourist visits Bangkok area and Chonburi area, which makes the revenue from tourist are heavy on the Bangkok area, while thailand tourists are more spread out across the region.\n\n\n\n\nthai_tourism_sp &lt;- thai_tourism %&gt;% \n  as_Spatial()\n\n\n\n\n\n\n\nCross-ValidationAIC\n\n\n\nbw_CV &lt;- bw.gwr(revenue_all ~ 1, \n             data = thai_tourism_sp,\n             approach = \"CV\",\n             adaptive = TRUE, \n             kernel = \"bisquare\", \n             longlat = T)\n\nAdaptive bandwidth: 55 CV score: 4428033682012956772066406 \nAdaptive bandwidth: 42 CV score: 4500834259376365885224440 \nAdaptive bandwidth: 64 CV score: 4381413976764054394448466 \nAdaptive bandwidth: 68 CV score: 4361239963255682344428408 \nAdaptive bandwidth: 72 CV score: 4345180954006887388486882 \nAdaptive bandwidth: 73 CV score: 4341733369505226221800826 \nAdaptive bandwidth: 75 CV score: 4335011644352382000840428 \nAdaptive bandwidth: 75 CV score: 4335011644352382000840428 \n\n\n\nbw_CV\n\n[1] 75\n\n\n\n\n\nbw_AIC &lt;- bw.gwr(revenue_all ~ 1, \n             data = thai_tourism_sp,\n             approach =\"AIC\",\n             adaptive = TRUE, \n             kernel = \"bisquare\", \n             longlat = T)\n\nAdaptive bandwidth (number of nearest neighbours): 55 AICc value: 4257.211 \nAdaptive bandwidth (number of nearest neighbours): 42 AICc value: 4258.925 \nAdaptive bandwidth (number of nearest neighbours): 64 AICc value: 4256.018 \nAdaptive bandwidth (number of nearest neighbours): 68 AICc value: 4255.513 \nAdaptive bandwidth (number of nearest neighbours): 72 AICc value: 4255.01 \nAdaptive bandwidth (number of nearest neighbours): 73 AICc value: 4254.876 \nAdaptive bandwidth (number of nearest neighbours): 75 AICc value: 4254.645 \nAdaptive bandwidth (number of nearest neighbours): 75 AICc value: 4254.645 \n\n\n\nbw_AIC\n\n[1] 75\n\n\n\n\n\n\n\n\n\ngwstat &lt;- gwss(data = thai_tourism_sp,\n               vars = \"revenue_all\",\n               bw = bw_AIC,\n               kernel = \"bisquare\",\n               adaptive = TRUE,\n               longlat = T)\n\n\ngwstat\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n\n   ***********************Calibration information*************************\n\n   Local summary statistics calculated for variables:\n    revenue_all\n   Number of summary points: 77\n   Kernel function: bisquare \n   Summary points: the same locations as observations are used.\n   Adaptive bandwidth: 75 (number of nearest neighbours)\n   Distance metric: Great Circle distance metric is used.\n\n   ************************Local Summary Statistics:**********************\n   Summary information for Local means:\nrevenue_all_LM \n       Min.     1st Qu.      Median     3rd Qu.        Max. \n38547533805 50753907508 69229936334 81792139502 93215970572 \n   Summary information for local standard deviation :\nrevenue_all_LSD \n        Min.      1st Qu.       Median      3rd Qu.         Max. \n108209116300 161382206285 232157919632 282418062711 304777922969 \n   Summary information for local variance :\nrevenue_all_LVar \n                   Min.                 1st Qu.                  Median \n11709212850467257713840 26044216505375674860220 53897299647833038652842 \n                3rd Qu.                    Max. \n79759962145408084344682 92889582329423068146404 \n   Summary information for Local skewness:\nrevenue_all_LSKe \n    Min.  1st Qu.   Median  3rd Qu.     Max. \n4.949413 5.332615 5.651104 6.384997 8.984196 \n   Summary information for localized coefficient of variation:\nrevenue_all_LCV \n    Min.  1st Qu.   Median  3rd Qu.     Max. \n2.793948 3.082332 3.338459 3.501539 3.793002 \n\n   ************************************************************************\n\n\n\n\n\n\ngwstat_tourism &lt;- as.data.frame(gwstat$SDF)\n\n\nthai_gstat &lt;- cbind(thai_tourism, gwstat_tourism)\n\n\n\n\n\ntm_shape(thai_gstat) +\n  tm_fill(\"revenue_all_LM\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Revenue Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.0,\n            legend.text.size = 0.5,\n            legend.height = 1.50, \n            legend.width = 1.50,\n            frame = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngwstat &lt;- gwss(data = thai_tourism_sp,\n               vars = \"revenue_all\",\n               bw = bw_AIC,\n               kernel = \"bisquare\",\n               adaptive = FALSE,\n               longlat = T)\n\n\n\n\n\ngwstat_tourism &lt;- as.data.frame(gwstat$SDF)\n\n\nthai_gstat &lt;- cbind(thai_tourism, gwstat_tourism)\n\n\n\n\n\ntm_shape(thai_gstat) +\n  tm_fill(\"revenue_all_LM\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Revenue Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.0,\n            legend.text.size = 0.5,\n            legend.height = 1.50, \n            legend.width = 1.50,\n            frame = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwm_q &lt;- poly2nb(thai_tourism, queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 \n 1  1  5 17 15 17 10  5  4  2 \n1 least connected region:\n14 with 1 link\n2 most connected regions:\n29 51 with 9 links\n\n\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1      S2\nW 76 5776 76 36.26113 315.652\n\n\n\n\n\n\nmoran.test(thai_tourism$revenue_all, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$revenue_all  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = -0.38565, p-value = 0.6501\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.032059694      -0.013333333       0.002357817 \n\n\n\nmoran.test(thai_tourism$revenue_foreign, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$revenue_foreign  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = -0.14552, p-value = 0.5578\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.021359589      -0.013333333       0.003042335 \n\n\n\nmoran.test(thai_tourism$revenue_thai, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$revenue_thai  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = -0.59004, p-value = 0.7224\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.037892905      -0.013333333       0.001732513 \n\n\n\nmoran.test(thai_tourism$no_tourist_all, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$no_tourist_all  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 0.24853, p-value = 0.4019\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.001276884      -0.013333333       0.002353354 \n\n\n\n\n\n\n\n\n\n\n\nwm_q &lt;- poly2nb(thai_tourism, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 \n 1  1  5 17 15 17 10  5  4  2 \n1 least connected region:\n14 with 1 link\n2 most connected regions:\n29 51 with 9 links\n\n\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1      S2\nW 76 5776 76 36.26113 315.652\n\n\n\n\n\n\nComputing Local Moran’s ILocal Moran’s I Valuesp-values\n\n\n\nfips &lt;- order(thai_tourism$province_eng)\nlocalMI &lt;- localmoran(thai_tourism$revenue_all, rswm_q)\nhead(localMI)\n\n           Ii          E.Ii      Var.Ii       Z.Ii  Pr(z != E(Ii))\n1 -1.83799860 -0.7673501158 2.138319789 -0.7321677 0.4640662019682\n2 -0.84568638 -0.0006847924 0.025995168 -5.2409644 0.0000001597396\n3 -0.42360090 -0.0007593821 0.014022725 -3.5707662 0.0003559385446\n4 -0.28298520 -0.0008584885 0.010273957 -2.7833981 0.0053792760572\n5  0.02378074 -0.0001327355 0.001343105  0.6525108 0.5140716849302\n6  0.05716301 -0.0010121113 0.018684887  0.4255906 0.6704061909293\n\n\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=thai_tourism$province_eng[fips]),\n  check.names=FALSE)\n\n                                     Ii           E.Ii         Var.Ii\nAmnat Charoen             0.07083095475 -0.00105904034  0.02642916197\nAng Thong                 0.05716300575 -0.00101211133  0.01868488708\nBangkok                  -1.83799860222 -0.76735011581  2.13831978877\nBueng Kan                 0.06881951236 -0.00099856395  0.02492143607\nBuriram                   0.04116994539 -0.00065817138  0.00958894589\nChachoengsao             -0.22456652797 -0.00065230008  0.00568869225\nChainat                   0.06867867168 -0.00098407156  0.01816774650\nChaiyaphum                0.03835985563 -0.00092325362  0.01704597461\nChanthaburi              -0.04814604279 -0.00050560248  0.00736728315\nChiang Mai               -0.13450098001 -0.00900973280  0.13016646377\nChiang Rai                0.01339027016 -0.00019489395  0.00486793509\nChonburi                 -0.25218265411 -0.04201669166  1.00556665353\nChumphon                 -0.02346538797 -0.00066103325  0.01650316319\nKalasin                   0.06188701939 -0.00100372369  0.01201031217\nKamphaeng Phet            0.06208705355 -0.00095083753  0.01384876288\nKanchanaburi             -0.01074825111 -0.00002760711  0.00040246374\nKhon Kaen                 0.02447102795 -0.00016316642  0.00124687144\nKrabi                     0.00647413741 -0.00235563243  0.04342954175\nLampang                   0.01006584072 -0.00070044464  0.00708353470\nLamphun                  -0.03456619366 -0.00094275090  0.02352980870\nLoei                      0.04652147598 -0.00073364096  0.00878094156\nLopburi                   0.04536393836 -0.00066944698  0.00583812969\nMae Hong Son             -0.07005053891 -0.00067593902  0.02565931441\nMaha Sarakham             0.06312827899 -0.00100611120  0.01465300243\nMukdahan                  0.06848945114 -0.00083509460  0.00999422441\nNakhon Nayok              0.04199015929 -0.00061097167  0.00890171030\nNakhon Pathom            -0.21489161570 -0.00068217102  0.00689886133\nNakhon Phanom             0.06804738203 -0.00088800034  0.02216452217\nNakhon Ratchasima         0.01076889014 -0.00003334270  0.00029096091\nNakhon Sawan              0.05851084146 -0.00072892287  0.00635643021\nNakhon Si Thammarat      -0.01515857173 -0.00026910394  0.00392212091\nNan                       0.06577903280 -0.00081505703  0.02034533972\nNarathiwat                0.07090949568 -0.00093157452  0.03535444476\nNong Bua Lamphu           0.04940749978 -0.00106478228  0.02657230378\nNong Khai                 0.05455144398 -0.00070366504  0.01299457961\nNonthaburi               -0.42360089900 -0.00075938213  0.01402272512\nPathum Thani             -0.28298519751 -0.00085848855  0.01027395737\nPattani                   0.03033040601 -0.00101893481  0.02542931850\nPhang Nga                 0.00535962987 -0.00001131013  0.00028254911\nPhatthalung               0.02253659477 -0.00090214141  0.01665653314\nPhayao                    0.04127232904 -0.00093588252  0.01727892278\nPhetchabun                0.04206480973 -0.00048503171  0.00490614010\nPhetchaburi              -0.00701853785 -0.00006659779  0.00166364987\nPhichit                   0.05997445991 -0.00096541858  0.01782371136\nPhitsanulok               0.04681828255 -0.00047233482  0.00565484930\nPhra Nakhon Si Ayutthaya  0.02378073991 -0.00013273550  0.00134310492\nPhrae                     0.06585844780 -0.00089707848  0.01306647591\nPhuket                    0.00000000000  0.00000000000  0.00000000000\nPrachinburi               0.04194069463 -0.00072835530  0.01345020233\nPrachuap Khiri Khan      -0.01444030941 -0.00046885706  0.01780196628\nRanong                   -0.01580883037 -0.00085754128  0.02140491550\nRatchaburi                0.03039770577 -0.00078959962  0.01150222035\nRayong                   -0.00373054925 -0.00000028939  0.00001099288\nRoi Et                    0.07316891133 -0.00097817034  0.01170484641\nSa Kaeo                   0.04167731057 -0.00066355668  0.00966735249\nSakon Nakhon              0.06323140237 -0.00087858230  0.01051421782\nSamut Prakan             -0.84568638003 -0.00068479243  0.02599516847\nSamut Sakhon             -0.46727833706 -0.00095876757  0.01770103720\nSamut Songkhram           0.03546514819 -0.00075636501  0.01888138672\nSaraburi                  0.03568908684 -0.00058367125  0.00850418209\nSatun                     0.01727953128 -0.00047189614  0.01178345101\nSing Buri                 0.06849618922 -0.00101639120  0.01480256807\nSisaket                   0.06869155659 -0.00094121430  0.01737726911\nSongkhla                 -0.04369438435 -0.00049426294  0.00720213315\nSukhothai                 0.05929615194 -0.00082070118  0.00982210874\nSuphan Buri               0.04352690070 -0.00063973702  0.00646999691\nSurat Thani              -0.01294059772 -0.00190596312  0.02773344116\nSurin                     0.06699652147 -0.00087318251  0.01612232273\nTak                       0.02038725673 -0.00057672306  0.00440533087\nTrang                     0.00879964494 -0.00055674285  0.01028287975\nTrat                      0.02097512255 -0.00015065121  0.01159839596\nUbon Ratchathani          0.06005136322 -0.00061752391  0.01541759291\nUdon Thani                0.04043400005 -0.00039635734  0.00474559843\nUthai Thani               0.04834655198 -0.00096439423  0.01404602297\nUttaradit                 0.06290286784 -0.00092453752  0.01706965728\nYala                      0.02976267619 -0.00085365356  0.02130795790\nYasothon                  0.07248548039 -0.00103478400  0.01507016045\n                                   Z.Ii Pr.z....E.Ii..\nAmnat Charoen             0.44220816550         0.6583\nAng Thong                 0.42559060009         0.6704\nBangkok                  -0.73216772361         0.4641\nBueng Kan                 0.44226375235         0.6583\nBuriram                   0.42715242646         0.6693\nChachoengsao             -2.96876260231         0.0030\nChainat                   0.51683276920         0.6053\nChaiyaphum                0.30088111946         0.7635\nChanthaburi              -0.55503719283         0.5789\nChiang Mai               -0.34782747363         0.7280\nChiang Rai                0.19471190228         0.8456\nChonburi                 -0.20958343283         0.8340\nChumphon                 -0.17751464598         0.8591\nKalasin                   0.57386478914         0.5661\nKamphaeng Phet            0.53566859548         0.5922\nKanchanaburi             -0.53438898432         0.5931\nKhon Kaen                 0.69763381711         0.4854\nKrabi                     0.04236983376         0.9662\nLampang                   0.12792071369         0.8982\nLamphun                  -0.21919618006         0.8265\nLoei                      0.50428761107         0.6141\nLopburi                   0.60247085905         0.5469\nMae Hong Son             -0.43308981172         0.6649\nMaha Sarakham             0.52981915887         0.5962\nMukdahan                  0.69344573929         0.4880\nNakhon Nayok              0.45152770242         0.6516\nNakhon Pathom            -2.57899148032         0.0099\nNakhon Phanom             0.46303412841         0.6433\nNakhon Ratchasima         0.63328064352         0.5266\nNakhon Sawan              0.74303056745         0.4575\nNakhon Si Thammarat      -0.23774899263         0.8121\nNan                       0.46687779020         0.6406\nNarathiwat                0.38207690115         0.7024\nNong Bua Lamphu           0.30962665227         0.7568\nNong Khai                 0.48472042815         0.6279\nNonthaburi               -3.57076617157         0.0004\nPathum Thani             -2.78339807865         0.0054\nPattani                   0.19658983250         0.8441\nPhang Nga                 0.31952388681         0.7493\nPhatthalung               0.18161088889         0.8559\nPhayao                    0.32109875280         0.7481\nPhetchabun                0.60747438907         0.5435\nPhetchaburi              -0.17044138455         0.8647\nPhichit                   0.45645977698         0.6481\nPhitsanulok               0.62887519637         0.5294\nPhra Nakhon Si Ayutthaya  0.65251083582         0.5141\nPhrae                     0.58399346585         0.5592\nPhuket                              NaN            NaN\nPrachinburi               0.36791590620         0.7129\nPrachuap Khiri Khan      -0.10471467926         0.9166\nRanong                   -0.10219317212         0.9186\nRatchaburi                0.29079505125         0.7712\nRayong                   -1.12507965880         0.2606\nRoi Et                    0.68534808378         0.4931\nSa Kaeo                   0.43063167601         0.6667\nSakon Nakhon              0.62522622775         0.5318\nSamut Prakan             -5.24096436405         0.0000\nSamut Sakhon             -3.50496983019         0.0005\nSamut Songkhram           0.26360257354         0.7921\nSaraburi                  0.39333654998         0.6941\nSatun                     0.16352984708         0.8701\nSing Buri                 0.57134032448         0.5678\nSisaket                   0.52822981910         0.5973\nSongkhla                 -0.50904291159         0.6107\nSukhothai                 0.60658807756         0.5441\nSuphan Buri               0.54908844219         0.5829\nSurat Thani              -0.06626070868         0.9472\nSurin                     0.53451777233         0.5930\nTak                       0.31585260712         0.7521\nTrang                     0.09226794222         0.9265\nTrat                      0.19616144815         0.8445\nUbon Ratchathani          0.48860481380         0.6251\nUdon Thani                0.59270376863         0.5534\nUthai Thani               0.41607023571         0.6774\nUttaradit                 0.48853399479         0.6252\nYala                      0.20974045792         0.8339\nYasothon                  0.59889146247         0.5492\n\n\n\nthai_tourism.localMI &lt;- cbind(thai_tourism,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\n\n\n\ntm_shape(thai_tourism.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\ntm_shape(thai_tourism.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\nSome legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nnci &lt;- moran.plot(thai_tourism$revenue_all, rswm_q,\n                  labels=as.character(thai_tourism$province_eng), \n                  xlab=\"Revenue from Tourist\", \n                  ylab=\"Spatially Lag Revenue from Tourist\")\n\n\n\n\n\n\n\n\nAs seen from the scatter plot, it can be seen that Chonburi, Phuket and Bangkok is way further from the cluster\n\n\n\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\n\nthai_tourism$lag_revenue &lt;- lag.listw(rswm_q, thai_tourism$revenue_all)\nDV &lt;- thai_tourism$lag_revenue - mean(thai_tourism$lag_revenue)     \n\nCentering local Moran around the mean value\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\nSet a statistical significance level\n\nsignif &lt;- 0.05\n\n\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 1 # low low\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2 # high low\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3 # low high\nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4 # high high\n\nThe non significant value of Moran will be placed in category 0\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\n\n\n\nthai_tourism.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(thai_tourism.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\nFrom the LISA Map, we can see that all the provinces surrounding Bangkok is a low-high autocorrelation, which means that all the surrounding provinces are low outlier, whereas Bangkok is a high outlier in terms of revenue from all tourists.\n\n\n\n\n\n\n\n\nwm_idw &lt;- thai_tourism %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wts = st_inverse_distance(nb, \n                              geometry, \n                              scale = 1,\n                              alpha = 1),\n         .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\n\nHCSA &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    revenue_all, nb, wts, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA\n\nSimple feature collection with 77 features and 24 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 77 × 25\n   gi_star cluster     e_gi   var_gi std_dev p_value p_sim p_folded_sim skewness\n     &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1  -0.533 High     1.25e-6 1.69e-12  -0.703 4.82e-1  0.28         0.14     1.82\n 2   7.45  Low      1.22e-6 1.14e-11   5.28  1.31e-7  0.08         0.04     4.64\n 3   3.49  Low      1.57e-6 8.33e-12   3.04  2.40e-3  0.12         0.06     2.91\n 4   3.05  Low      1.38e-6 6.11e-12   3.11  1.85e-3  0.1          0.05     3.91\n 5  -0.627 Low      1.25e-6 2.07e-12  -0.668 5.04e-1  0.3          0.15     2.32\n 6  -0.387 Low      1.25e-6 4.45e-12  -0.407 6.84e-1  0.98         0.49     3.04\n 7  -0.594 Low      1.03e-6 1.74e-12  -0.538 5.91e-1  0.6          0.3      2.83\n 8  -0.549 Low      1.46e-6 5.35e-12  -0.563 5.73e-1  0.14         0.07     2.59\n 9  -0.509 Low      1.16e-6 3.63e-12  -0.549 5.83e-1  0.16         0.08     3.05\n10  -0.395 Low      7.75e-7 1.38e-12  -0.337 7.36e-1  1            0.5      3.10\n# ℹ 67 more rows\n# ℹ 16 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, Shape_Leng &lt;dbl&gt;,\n#   Shape_Area &lt;dbl&gt;, province_eng &lt;chr&gt;, revenue_all &lt;dbl&gt;,\n#   revenue_thai &lt;dbl&gt;, revenue_foreign &lt;dbl&gt;, no_tourist_stay &lt;dbl&gt;,\n#   no_tourist_all &lt;dbl&gt;, no_tourist_thai &lt;dbl&gt;, no_tourist_foreign &lt;dbl&gt;,\n#   ratio_tourist_stay &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;, lag_revenue &lt;dbl&gt;\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\nHCSA_sig &lt;- HCSA  %&gt;%\n  filter(p_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig) +\n  tm_fill(\"cluster\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n\nFindings: There is no hotspot area in the plot above and there are coldspots identified in Ubon-Ratchathani, Yasothon, Roi Et and Mukdahan provinces.\n\n\n\n\n\ncluster_vars.cor = cor(tourism_data[,2:9])\ncorrplot.mixed(cluster_vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n\n\n\n\n\n\n\n\nFrom the correlation analysis, there is an interesting finding. Overall revenue are strongly correlated with number of foreign tourist, but it’s less stronger with the number of thai tourists. This may be due to foreign tourists contributing more revenue and spending more money as compared to local tourists.\n\n\n\n\n\nLet us create a time series cube based on the revenue generated from tourism in Thailand\n\ntourism_revenue &lt;- tourism %&gt;%\n  filter(variable %in% c(\"revenue_all\"))\n\n\ntourism_revenue &lt;- left_join(boundary, tourism_revenue, by = c(\"province_eng\"))\n\nDerive a dataframe grouped by the year and province in Thailand\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  group_by(year, province_eng, geometry) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n`summarise()` has grouped output by 'year', 'province_eng'. You can override\nusing the `.groups` argument.\n\n\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\n\ntourism_st &lt;- spacetime(tourism_revenue, boundary,\n                      .loc_col = \"province_eng\",\n                      .time_col = \"year\")\n\n\nis_spacetime_cube(tourism_st)\n\n[1] TRUE\n\n\n\n\n\n\n\n\ntourism_nb &lt;- tourism_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb, \n                             geometry, \n                             scale = 1,\n                             alpha = 1),\n    .before = 1) %&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\n\n\n\n\ngi_stars &lt;- tourism_nb %&gt;% \n  group_by(year) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    revenue_all, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\n\ngi_stars\n\nSimple feature collection with 385 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 385 × 16\n# Groups:   year [5]\n    year province_eng                   geometry revenue_all nb    wt    gi_star\n   &lt;dbl&gt; &lt;chr&gt;                &lt;MULTIPOLYGON [m]&gt;       &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n 1  2019 Bangkok       (((674339.8 1543300, 674…     1.07e12 &lt;int&gt; &lt;dbl&gt;   5.24 \n 2  2019 Samut Prakan  (((687139.8 1517113, 687…     7.01e 9 &lt;int&gt; &lt;dbl&gt;   3.62 \n 3  2019 Nonthaburi    (((644817.9 1559286, 644…     4.66e 9 &lt;int&gt; &lt;dbl&gt;   2.83 \n 4  2019 Pathum Thani  (((704086 1575736, 70408…     3.47e 9 &lt;int&gt; &lt;dbl&gt;   2.33 \n 5  2019 Phra Nakhon … (((662941.6 1620856, 662…     1.92e10 &lt;int&gt; &lt;dbl&gt;  -0.653\n 6  2019 Ang Thong     (((643472.8 1636469, 643…     1.01e 9 &lt;int&gt; &lt;dbl&gt;  -0.568\n 7  2019 Lopburi       (((751293.3 1742960, 751…     5.75e 9 &lt;int&gt; &lt;dbl&gt;  -0.699\n 8  2019 Sing Buri     (((647136.1 1668671, 647…     8.78e 8 &lt;int&gt; &lt;dbl&gt;  -0.675\n 9  2019 Chainat       (((620165.4 1704256, 620…     1.34e 9 &lt;int&gt; &lt;dbl&gt;  -0.628\n10  2019 Saraburi      (((757935.1 1667886, 757…     6.81e 9 &lt;int&gt; &lt;dbl&gt;  -0.513\n# ℹ 375 more rows\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n\n\n\n\n\n\n\nH0: There is no monotonic trend over time\nH1: Monotonic trend is present\nReject null hypothesis if the p-value is smaller than alpha value\nTau range interpretation:\n\n-1 = perfectly decreasing series\n1 = perfectly increasing series\n\n\n\n\nLet us choose Bangkok to analyze as Bangkok has the highest revenue from tourism\n\ncbg &lt;- gi_stars %&gt;% \n  ungroup() %&gt;% \n  filter(province_eng == \"Bangkok\") |&gt; \n  select(province_eng, year, gi_star)\n\n\nggplot(data = cbg, \n       aes(x = year, \n           y = gi_star)) +\n  geom_line() +\n  theme_light()\n\n\n\n\n\n\n\n\nFindings:\n\nFrom 2019 to 2022, the Gi* value decreases, which indicates that there is an increasing trend towards cold spots during this period of time\nFrom 2022 to 2023, the Gi* value increases, which indicates that the spatial clustering increases towards hot spots in this period\n\n\ncbg %&gt;%\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr::unnest_wider(mk)\n\n# A tibble: 1 × 6\n     tau    sl     S     D  varS                                        geometry\n   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                              &lt;MULTIPOLYGON [m]&gt;\n1 -0.600 0.221    -6    10  16.7 (((674339.8 1543300, 674382.3 1543278, 674448.…\n\n\nThe p-value is 0.22, we do not reject null hypothesis and conclude that there is no monotonic trend (Bangkok)\nWe can see the overall result per province using the following code\n\nehsa &lt;- gi_stars %&gt;%\n  group_by(province_eng) %&gt;%\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mk)\nhead(ehsa)\n\n# A tibble: 6 × 7\n  province_eng     tau    sl     S     D  varS                          geometry\n  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                &lt;MULTIPOLYGON [m]&gt;\n1 Amnat Charoen  0     1         0    10  16.7 (((1137720 1809629, 1137724 1809…\n2 Ang Thong      0.400 0.462     4    10  16.7 (((643472.8 1636469, 643496 1636…\n3 Bangkok       -0.600 0.221    -6    10  16.7 (((674339.8 1543300, 674382.3 15…\n4 Bueng Kan      0.200 0.806     2    10  16.7 (((965496 2045531, 965625.5 2045…\n5 Buriram       -0.200 0.806    -2    10  16.7 (((921217 1750212, 921217 175021…\n6 Chachoengsao  -0.200 0.806    -2    10  16.7 (((722656.1 1546054, 722796 1546…\n\n\n\nehsa_desc &lt;- ehsa %&gt;%\n  arrange(desc(tau))\n\nhead(ehsa_desc)\n\n# A tibble: 6 × 7\n  province_eng            tau     sl     S     D  varS                  geometry\n  &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;MULTIPOLYGON [m]&gt;\n1 Phra Nakhon Si Ayutt… 0.800 0.0864     8    10  16.7 (((662941.6 1620856, 662…\n2 Phayao                0.600 0.221      6    10  16.7 (((648755.2 2182064, 648…\n3 Uthai Thani           0.600 0.221      6    10  16.7 (((514892 1746436, 51490…\n4 Ang Thong             0.400 0.462      4    10  16.7 (((643472.8 1636469, 643…\n5 Loei                  0.400 0.462      4    10  16.7 (((827375.5 2016969, 827…\n6 Phetchabun            0.400 0.462      4    10  16.7 (((755146.4 1900816, 755…\n\n\nFindings: The shown sorted table is based on the Tau range, which shows that the value shown has increasing trend. The consistent growth indicates that there is potential growth in tourism revenue in these provinces.\n\nehsa_asc &lt;- ehsa %&gt;%\n  arrange(tau)\n\nhead(ehsa_asc)\n\n# A tibble: 6 × 7\n  province_eng           tau     sl     S     D  varS                   geometry\n  &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;MULTIPOLYGON [m]&gt;\n1 Krabi               -0.800 0.0864    -8    10  16.7 (((512499 827838.6, 51250…\n2 Nakhon Si Thammarat -0.800 0.0864    -8    10  16.7 (((585074.4 1029631, 5850…\n3 Phang Nga           -0.800 0.0864    -8    10  16.7 (((457515.4 856050.4, 457…\n4 Trang               -0.800 0.0864    -8    10  16.7 (((552555.6 770748.6, 552…\n5 Bangkok             -0.600 0.221     -6    10  16.7 (((674339.8 1543300, 6743…\n6 Nonthaburi          -0.600 0.221     -6    10  16.7 (((644817.9 1559286, 6448…\n\n\nFindings: The provinces shown in above table indicates that those are the provinces with decreasing series. It is interesting to find that Bangkok is part of the top 5 decreasing series even though Bangkok has the highest revenue in tourism. This indicates that the tourism sector should pay more attention to these provinces and avoid decreasing trend.\n\n\n\n\n\nFrom the analysis, we can find that Bangkok area has a lot of tourism activity, but it doesnt show monotonic trend over time, which indicates that it is not an increasing trend and it fluctuates randomly over time. Under the hotspot and coldspot analysis, we can find that the Ubon-Ratchathani, Yasothon, Roi Et and Mukdahan provinces are considered as cold spots. This might indicate that these provinces lack of tourism infrastructure. It is a potential area for the Thailand tourism sector to pay more attention to and drive tourism traffic to the cold spots area and maintain stability of tourism activity in Bangkok area."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#overview",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#overview",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "In this analysis, we are interested to discover:\n\nIf the key indicators of tourism economy of Thailand are independent from space and time"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#getting-started",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#getting-started",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, knitr, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, GGally, GWmodel,\n               ggstatsplot, Kendall, plotly, sfdep)\n\n\n\n\n\nAspatial DataGeospatial Data\n\n\n\ntourism &lt;- read_csv(\"data/aspatial/thailand_domestic_tourism_2019_2023_ver2.csv\") %&gt;% \n  mutate(year = year(date))\n\nRows: 30800 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): province_thai, province_eng, region_thai, region_eng, variable\ndbl  (1): value\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nboundary &lt;- st_read(dsn = \"data/geospatial\",\n                        layer = \"tha_admbnda_adm1_rtsd_20220121\") %&gt;% \n  st_transform(crs = 32647)\n\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\brigittatsai\\ISSS626_AY2024-25_T1\\Take-home_Ex\\Take-home_Ex02\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#data-wrangling",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#data-wrangling",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "boundary &lt;- boundary %&gt;%\n  rename(province_eng = ADM1_EN)\n\n\nboundary &lt;- boundary[, !(names(boundary) %in% c(\"ADM3_REF\", \"ADM3ALT1EN\", \"ADM3ALT2EN\", \"ADM3ALT1TH\", \"ADM3ALT2TH\", \"ADM3_TH\",\"ADM2_TH\", \"ADM1_TH\", \"ADM0_TH\", \"ADM0_EN\", \"ADM0_PCODE\", \"ADM3_PCODE\", \"ADM2_PCODE\", \"validOn\", \"validTo\", \"ADM1_PCODE\", \"date\", \"ADM1_REF\", \"ADM1ALT1EN\", \"ADM1ALT2EN\", \"ADM1ALT1TH\", \"ADM1ALT2TH\"))]\n\n\nboundary[is.na(boundary$Shape_Leng), ]\n\nSimple feature collection with 0 features and 3 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: WGS 84 / UTM zone 47N\n[1] Shape_Leng   Shape_Area   province_eng geometry    \n&lt;0 rows&gt; (or 0-length row.names)\n\n\n\n\n\n\ntourism &lt;- tourism[, !(names(tourism) %in% c(\"province_thai\", \"region_thai\"))]\n\n\nunique(tourism$variable)\n\n[1] \"ratio_tourist_stay\" \"no_tourist_stay\"    \"no_tourist_all\"    \n[4] \"no_tourist_thai\"    \"no_tourist_foreign\" \"revenue_all\"       \n[7] \"revenue_thai\"       \"revenue_foreign\"   \n\n\n\noptions(scipen = 999) # to display full number when summing up the value column\n\nRevenue generated by tourism industry\n\nrevenue_all &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"revenue_all\"))\n\n\nrevenue_all &lt;- revenue_all %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nrevenue_all &lt;- revenue_all %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nRevenue generated by Thai tourists\n\nrevenue_thai &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"revenue_thai\"))\n\n\nrevenue_thai &lt;- revenue_thai %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nrevenue_thai &lt;- revenue_thai %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nRevenue generated by foreign tourists\n\nrevenue_foreign &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"revenue_foreign\"))\n\n\nrevenue_foreign &lt;- revenue_foreign %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nrevenue_foreign &lt;- revenue_foreign %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of tourists who stay overnight\n\ntourist_stay &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_stay\"))\n\n\ntourist_stay &lt;- tourist_stay %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_stay &lt;- tourist_stay %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of domestic tourists who visited the province\n\ntourist_all &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_all\"))\n\n\ntourist_all &lt;- tourist_all %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_all &lt;- tourist_all %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of Thai tourists who visited the province\n\ntourist_thai &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_thai\"))\n\n\ntourist_thai &lt;- tourist_thai %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_thai &lt;- tourist_thai %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nNumber of foreign tourists who visited the province\n\ntourist_foreign &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"no_tourist_foreign\"))\n\n\ntourist_foreign &lt;- tourist_foreign %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n\ntourist_foreign &lt;- tourist_foreign %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\nRatio of tourist stay overnight\nRatio = Total rooms booked/ total available rooms\n\nratio_tourist &lt;- tourism %&gt;%\n  filter(tourism$variable %in% c(\"ratio_tourist_stay\"))\n\nFor this column, we will use median to aggregate the values as it is not appropriate to sum ratio values\n\nratio_tourist &lt;- ratio_tourist %&gt;%\n  group_by(province_eng) %&gt;%\n  summarize(value = median(value, na.rm = TRUE),\n            variable = first(variable))\n\n\nratio_tourist &lt;- ratio_tourist %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\n\n\n\n\n\nAs seen in previous section, the tourism dataset is divided into each variables to sum the values. Let’s first join the tourism dataset into 1 again.\n\ntourism_data &lt;- revenue_all %&gt;%\n  left_join(revenue_thai, by = \"province_eng\") %&gt;%\n  left_join(revenue_foreign, by = \"province_eng\") %&gt;%\n  left_join(tourist_stay, by = \"province_eng\") %&gt;% \n  left_join(tourist_all, by = \"province_eng\") %&gt;% \n  left_join(tourist_thai, by = \"province_eng\") %&gt;% \n  left_join(tourist_foreign, by = \"province_eng\") %&gt;% \n  left_join(ratio_tourist, by = \"province_eng\")\n\n\n\n\nNow, let us join both boundary and tourism data\n\nthai_tourism &lt;- left_join(boundary, tourism_data, by = c(\"province_eng\"))\n\nLet us check if there is unmatched rows to ensure data is accurate\n\nunmatched &lt;- thai_tourism %&gt;% \n  filter(is.na(Shape_Leng))\n\nprint(unmatched)\n\nSimple feature collection with 0 features and 11 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: WGS 84 / UTM zone 47N\n [1] Shape_Leng         Shape_Area         province_eng       revenue_all       \n [5] revenue_thai       revenue_foreign    no_tourist_stay    no_tourist_all    \n [9] no_tourist_thai    no_tourist_foreign ratio_tourist_stay geometry          \n&lt;0 rows&gt; (or 0-length row.names)\n\n\nThere are multiple missing values after joining the table. This is due to different spacings of province name. Let us check using the code below\n\ncheck_value &lt;- tourism %&gt;%\n  filter(province_eng %in% c(\"Buriram\", \"Chainat\", \"Chonburi\", \"Lopburi\", \"Nong Bua Lamphu\", \"Phang Nga\", \"Prachinburi\", \"Sisaket\"))\n\nprint(check_value)\n\n# A tibble: 3,200 × 6\n   date       province_eng    region_eng     variable           value  year\n   &lt;date&gt;     &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;\n 1 2019-01-01 Lopburi         central        ratio_tourist_stay  61.3  2019\n 2 2019-01-01 Chainat         central        ratio_tourist_stay  79.3  2019\n 3 2019-01-01 Chonburi        east           ratio_tourist_stay  84.3  2019\n 4 2019-01-01 Prachinburi     east           ratio_tourist_stay  68.6  2019\n 5 2019-01-01 Phang Nga       south          ratio_tourist_stay  86.5  2019\n 6 2019-01-01 Buriram         east_northeast ratio_tourist_stay  71.3  2019\n 7 2019-01-01 Sisaket         south          ratio_tourist_stay  68.6  2019\n 8 2019-01-01 Nong Bua Lamphu east_northeast ratio_tourist_stay  65.0  2019\n 9 2020-01-01 Lopburi         central        ratio_tourist_stay  51.5  2020\n10 2020-01-01 Chainat         central        ratio_tourist_stay  73.5  2020\n# ℹ 3,190 more rows\n\n\n\ncheck_value2 &lt;- boundary %&gt;%\n  filter(province_eng %in% c(\"Buri Ram\", \"Chai Nat\", \"Chon Buri\", \"Lop Buri\", \"Nong Bua Lam Phu\", \"Phangnga\", \"Prachin Buri\", \"Si Sa Ket\"))\n\nprint(check_value2)\n\nSimple feature collection with 8 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 349324.1 ymin: 856050.4 xmax: 1137931 ymax: 1959175\nProjected CRS: WGS 84 / UTM zone 47N\n  Shape_Leng Shape_Area     province_eng                       geometry\n1   5.693342  0.5457884         Lop Buri MULTIPOLYGON (((751293.3 17...\n2   2.896316  0.2090783         Chai Nat MULTIPOLYGON (((620165.4 17...\n3   6.091786  0.3756301        Chon Buri MULTIPOLYGON (((714273.8 13...\n4   4.705205  0.4223316     Prachin Buri MULTIPOLYGON (((768228.7 15...\n5   8.701860  0.8445370         Buri Ram MULTIPOLYGON (((921217 1750...\n6   6.354893  0.7461402        Si Sa Ket MULTIPOLYGON (((1047999 172...\n7   4.478819  0.3451953 Nong Bua Lam Phu MULTIPOLYGON (((848689.2 19...\n8   9.158469  0.3364923         Phangnga MULTIPOLYGON (((457515.4 85...\n\n\nNotice that the writings are inconsistent. Let us standardize it by changing the name in the boundary data\n\nboundary &lt;- boundary %&gt;%\n  mutate(province_eng = recode(province_eng,\n                          \"Buri Ram\" = \"Buriram\",\n                          \"Chai Nat\" = \"Chainat\",\n                          \"Chon Buri\" = \"Chonburi\",\n                          \"Nong Bua Lam Phu\" = \"Nong Bua Lamphu\",\n                          \"Phangnga\" = \"Phang Nga\",\n                          \"Prachin Buri\" = \"Prachinburi\",\n                          \"Si Sa Ket\" = \"Sisaket\",\n                          \"Lop Buri\" = \"Lopburi\"))\n\nLet us join the table again\n\nthai_tourism &lt;- left_join(boundary, tourism_data, by = c(\"province_eng\"))\n\nLet us do final check if there is any missing value\n\nmissing &lt;- thai_tourism %&gt;% \n  filter(is.na(Shape_Leng))\n\nprint(missing)\n\nSimple feature collection with 0 features and 11 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: WGS 84 / UTM zone 47N\n [1] Shape_Leng         Shape_Area         province_eng       revenue_all       \n [5] revenue_thai       revenue_foreign    no_tourist_stay    no_tourist_all    \n [9] no_tourist_thai    no_tourist_foreign ratio_tourist_stay geometry          \n&lt;0 rows&gt; (or 0-length row.names)\n\n\nThere is no missing value in the final dataset. The dataset is ready to be used for analysis\n\n\n\n\nLet us create a time series cube based on the revenue generated from tourism in Thailand\n\ntourism_revenue &lt;- tourism %&gt;%\n  filter(variable %in% c(\"revenue_all\"))\n\nDerive a dataframe grouped by the year and province in Thailand\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  group_by(year, province_eng) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n\n\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\n\ntourism_st &lt;- spacetime(tourism_revenue, boundary,\n                      .loc_col = \"province_eng\",\n                      .time_col = \"year\")\n\n\nis_spacetime_cube(tourism_st)\n\n[1] TRUE"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#geographically-weighted-summary-statistics",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#geographically-weighted-summary-statistics",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "class(thai_tourism)\n\n[1] \"sf\"         \"data.frame\"\n\n\n\nbasemap &lt;- tm_shape(thai_tourism) +\n  tm_polygons() +\n  tm_text(\"province_eng\", size=0.5)\n\ngdppc &lt;- qtm(thai_tourism, \"revenue_all\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\nSome legend labels were too wide. These labels have been resized to 0.64, 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\nbasemap &lt;- tm_shape(thai_tourism) +\n  tm_polygons() +\n  tm_text(\"province_eng\", size=0.5)\n\ngdppc &lt;- qtm(thai_tourism, \"no_tourist_thai\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nbasemap &lt;- tm_shape(thai_tourism) +\n  tm_polygons() +\n  tm_text(\"province_eng\", size=0.5)\n\ngdppc &lt;- qtm(thai_tourism, \"no_tourist_foreign\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\nFindings:\nFrom the choropleth map, we can roughly see that most foreign tourist visits Bangkok area and Chonburi area, which makes the revenue from tourist are heavy on the Bangkok area, while thailand tourists are more spread out across the region.\n\n\n\n\nthai_tourism_sp &lt;- thai_tourism %&gt;% \n  as_Spatial()\n\n\n\n\n\n\n\nCross-ValidationAIC\n\n\n\nbw_CV &lt;- bw.gwr(revenue_all ~ 1, \n             data = thai_tourism_sp,\n             approach = \"CV\",\n             adaptive = TRUE, \n             kernel = \"bisquare\", \n             longlat = T)\n\nAdaptive bandwidth: 55 CV score: 4428033682012956772066406 \nAdaptive bandwidth: 42 CV score: 4500834259376365885224440 \nAdaptive bandwidth: 64 CV score: 4381413976764054394448466 \nAdaptive bandwidth: 68 CV score: 4361239963255682344428408 \nAdaptive bandwidth: 72 CV score: 4345180954006887388486882 \nAdaptive bandwidth: 73 CV score: 4341733369505226221800826 \nAdaptive bandwidth: 75 CV score: 4335011644352382000840428 \nAdaptive bandwidth: 75 CV score: 4335011644352382000840428 \n\n\n\nbw_CV\n\n[1] 75\n\n\n\n\n\nbw_AIC &lt;- bw.gwr(revenue_all ~ 1, \n             data = thai_tourism_sp,\n             approach =\"AIC\",\n             adaptive = TRUE, \n             kernel = \"bisquare\", \n             longlat = T)\n\nAdaptive bandwidth (number of nearest neighbours): 55 AICc value: 4257.211 \nAdaptive bandwidth (number of nearest neighbours): 42 AICc value: 4258.925 \nAdaptive bandwidth (number of nearest neighbours): 64 AICc value: 4256.018 \nAdaptive bandwidth (number of nearest neighbours): 68 AICc value: 4255.513 \nAdaptive bandwidth (number of nearest neighbours): 72 AICc value: 4255.01 \nAdaptive bandwidth (number of nearest neighbours): 73 AICc value: 4254.876 \nAdaptive bandwidth (number of nearest neighbours): 75 AICc value: 4254.645 \nAdaptive bandwidth (number of nearest neighbours): 75 AICc value: 4254.645 \n\n\n\nbw_AIC\n\n[1] 75\n\n\n\n\n\n\n\n\n\ngwstat &lt;- gwss(data = thai_tourism_sp,\n               vars = \"revenue_all\",\n               bw = bw_AIC,\n               kernel = \"bisquare\",\n               adaptive = TRUE,\n               longlat = T)\n\n\ngwstat\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n\n   ***********************Calibration information*************************\n\n   Local summary statistics calculated for variables:\n    revenue_all\n   Number of summary points: 77\n   Kernel function: bisquare \n   Summary points: the same locations as observations are used.\n   Adaptive bandwidth: 75 (number of nearest neighbours)\n   Distance metric: Great Circle distance metric is used.\n\n   ************************Local Summary Statistics:**********************\n   Summary information for Local means:\nrevenue_all_LM \n       Min.     1st Qu.      Median     3rd Qu.        Max. \n38547533805 50753907508 69229936334 81792139502 93215970572 \n   Summary information for local standard deviation :\nrevenue_all_LSD \n        Min.      1st Qu.       Median      3rd Qu.         Max. \n108209116300 161382206285 232157919632 282418062711 304777922969 \n   Summary information for local variance :\nrevenue_all_LVar \n                   Min.                 1st Qu.                  Median \n11709212850467257713840 26044216505375674860220 53897299647833038652842 \n                3rd Qu.                    Max. \n79759962145408084344682 92889582329423068146404 \n   Summary information for Local skewness:\nrevenue_all_LSKe \n    Min.  1st Qu.   Median  3rd Qu.     Max. \n4.949413 5.332615 5.651104 6.384997 8.984196 \n   Summary information for localized coefficient of variation:\nrevenue_all_LCV \n    Min.  1st Qu.   Median  3rd Qu.     Max. \n2.793948 3.082332 3.338459 3.501539 3.793002 \n\n   ************************************************************************\n\n\n\n\n\n\ngwstat_tourism &lt;- as.data.frame(gwstat$SDF)\n\n\nthai_gstat &lt;- cbind(thai_tourism, gwstat_tourism)\n\n\n\n\n\ntm_shape(thai_gstat) +\n  tm_fill(\"revenue_all_LM\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Revenue Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.0,\n            legend.text.size = 0.5,\n            legend.height = 1.50, \n            legend.width = 1.50,\n            frame = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngwstat &lt;- gwss(data = thai_tourism_sp,\n               vars = \"revenue_all\",\n               bw = bw_AIC,\n               kernel = \"bisquare\",\n               adaptive = FALSE,\n               longlat = T)\n\n\n\n\n\ngwstat_tourism &lt;- as.data.frame(gwstat$SDF)\n\n\nthai_gstat &lt;- cbind(thai_tourism, gwstat_tourism)\n\n\n\n\n\ntm_shape(thai_gstat) +\n  tm_fill(\"revenue_all_LM\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Revenue Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.0,\n            legend.text.size = 0.5,\n            legend.height = 1.50, \n            legend.width = 1.50,\n            frame = TRUE)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#global-measures-of-spatial-association",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#global-measures-of-spatial-association",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "wm_q &lt;- poly2nb(thai_tourism, queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 \n 1  1  5 17 15 17 10  5  4  2 \n1 least connected region:\n14 with 1 link\n2 most connected regions:\n29 51 with 9 links\n\n\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1      S2\nW 76 5776 76 36.26113 315.652\n\n\n\n\n\n\nmoran.test(thai_tourism$revenue_all, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$revenue_all  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = -0.38565, p-value = 0.6501\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.032059694      -0.013333333       0.002357817 \n\n\n\nmoran.test(thai_tourism$revenue_foreign, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$revenue_foreign  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = -0.14552, p-value = 0.5578\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.021359589      -0.013333333       0.003042335 \n\n\n\nmoran.test(thai_tourism$revenue_thai, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$revenue_thai  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = -0.59004, p-value = 0.7224\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.037892905      -0.013333333       0.001732513 \n\n\n\nmoran.test(thai_tourism$no_tourist_all, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  thai_tourism$no_tourist_all  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 0.24853, p-value = 0.4019\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.001276884      -0.013333333       0.002353354"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#local-measures-of-spatial-association",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#local-measures-of-spatial-association",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "wm_q &lt;- poly2nb(thai_tourism, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\nLink number distribution:\n\n 0  1  2  3  4  5  6  7  8  9 \n 1  1  5 17 15 17 10  5  4  2 \n1 least connected region:\n14 with 1 link\n2 most connected regions:\n29 51 with 9 links\n\n\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n67\n2 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1      S2\nW 76 5776 76 36.26113 315.652\n\n\n\n\n\n\nComputing Local Moran’s ILocal Moran’s I Valuesp-values\n\n\n\nfips &lt;- order(thai_tourism$province_eng)\nlocalMI &lt;- localmoran(thai_tourism$revenue_all, rswm_q)\nhead(localMI)\n\n           Ii          E.Ii      Var.Ii       Z.Ii  Pr(z != E(Ii))\n1 -1.83799860 -0.7673501158 2.138319789 -0.7321677 0.4640662019682\n2 -0.84568638 -0.0006847924 0.025995168 -5.2409644 0.0000001597396\n3 -0.42360090 -0.0007593821 0.014022725 -3.5707662 0.0003559385446\n4 -0.28298520 -0.0008584885 0.010273957 -2.7833981 0.0053792760572\n5  0.02378074 -0.0001327355 0.001343105  0.6525108 0.5140716849302\n6  0.05716301 -0.0010121113 0.018684887  0.4255906 0.6704061909293\n\n\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=thai_tourism$province_eng[fips]),\n  check.names=FALSE)\n\n                                     Ii           E.Ii         Var.Ii\nAmnat Charoen             0.07083095475 -0.00105904034  0.02642916197\nAng Thong                 0.05716300575 -0.00101211133  0.01868488708\nBangkok                  -1.83799860222 -0.76735011581  2.13831978877\nBueng Kan                 0.06881951236 -0.00099856395  0.02492143607\nBuriram                   0.04116994539 -0.00065817138  0.00958894589\nChachoengsao             -0.22456652797 -0.00065230008  0.00568869225\nChainat                   0.06867867168 -0.00098407156  0.01816774650\nChaiyaphum                0.03835985563 -0.00092325362  0.01704597461\nChanthaburi              -0.04814604279 -0.00050560248  0.00736728315\nChiang Mai               -0.13450098001 -0.00900973280  0.13016646377\nChiang Rai                0.01339027016 -0.00019489395  0.00486793509\nChonburi                 -0.25218265411 -0.04201669166  1.00556665353\nChumphon                 -0.02346538797 -0.00066103325  0.01650316319\nKalasin                   0.06188701939 -0.00100372369  0.01201031217\nKamphaeng Phet            0.06208705355 -0.00095083753  0.01384876288\nKanchanaburi             -0.01074825111 -0.00002760711  0.00040246374\nKhon Kaen                 0.02447102795 -0.00016316642  0.00124687144\nKrabi                     0.00647413741 -0.00235563243  0.04342954175\nLampang                   0.01006584072 -0.00070044464  0.00708353470\nLamphun                  -0.03456619366 -0.00094275090  0.02352980870\nLoei                      0.04652147598 -0.00073364096  0.00878094156\nLopburi                   0.04536393836 -0.00066944698  0.00583812969\nMae Hong Son             -0.07005053891 -0.00067593902  0.02565931441\nMaha Sarakham             0.06312827899 -0.00100611120  0.01465300243\nMukdahan                  0.06848945114 -0.00083509460  0.00999422441\nNakhon Nayok              0.04199015929 -0.00061097167  0.00890171030\nNakhon Pathom            -0.21489161570 -0.00068217102  0.00689886133\nNakhon Phanom             0.06804738203 -0.00088800034  0.02216452217\nNakhon Ratchasima         0.01076889014 -0.00003334270  0.00029096091\nNakhon Sawan              0.05851084146 -0.00072892287  0.00635643021\nNakhon Si Thammarat      -0.01515857173 -0.00026910394  0.00392212091\nNan                       0.06577903280 -0.00081505703  0.02034533972\nNarathiwat                0.07090949568 -0.00093157452  0.03535444476\nNong Bua Lamphu           0.04940749978 -0.00106478228  0.02657230378\nNong Khai                 0.05455144398 -0.00070366504  0.01299457961\nNonthaburi               -0.42360089900 -0.00075938213  0.01402272512\nPathum Thani             -0.28298519751 -0.00085848855  0.01027395737\nPattani                   0.03033040601 -0.00101893481  0.02542931850\nPhang Nga                 0.00535962987 -0.00001131013  0.00028254911\nPhatthalung               0.02253659477 -0.00090214141  0.01665653314\nPhayao                    0.04127232904 -0.00093588252  0.01727892278\nPhetchabun                0.04206480973 -0.00048503171  0.00490614010\nPhetchaburi              -0.00701853785 -0.00006659779  0.00166364987\nPhichit                   0.05997445991 -0.00096541858  0.01782371136\nPhitsanulok               0.04681828255 -0.00047233482  0.00565484930\nPhra Nakhon Si Ayutthaya  0.02378073991 -0.00013273550  0.00134310492\nPhrae                     0.06585844780 -0.00089707848  0.01306647591\nPhuket                    0.00000000000  0.00000000000  0.00000000000\nPrachinburi               0.04194069463 -0.00072835530  0.01345020233\nPrachuap Khiri Khan      -0.01444030941 -0.00046885706  0.01780196628\nRanong                   -0.01580883037 -0.00085754128  0.02140491550\nRatchaburi                0.03039770577 -0.00078959962  0.01150222035\nRayong                   -0.00373054925 -0.00000028939  0.00001099288\nRoi Et                    0.07316891133 -0.00097817034  0.01170484641\nSa Kaeo                   0.04167731057 -0.00066355668  0.00966735249\nSakon Nakhon              0.06323140237 -0.00087858230  0.01051421782\nSamut Prakan             -0.84568638003 -0.00068479243  0.02599516847\nSamut Sakhon             -0.46727833706 -0.00095876757  0.01770103720\nSamut Songkhram           0.03546514819 -0.00075636501  0.01888138672\nSaraburi                  0.03568908684 -0.00058367125  0.00850418209\nSatun                     0.01727953128 -0.00047189614  0.01178345101\nSing Buri                 0.06849618922 -0.00101639120  0.01480256807\nSisaket                   0.06869155659 -0.00094121430  0.01737726911\nSongkhla                 -0.04369438435 -0.00049426294  0.00720213315\nSukhothai                 0.05929615194 -0.00082070118  0.00982210874\nSuphan Buri               0.04352690070 -0.00063973702  0.00646999691\nSurat Thani              -0.01294059772 -0.00190596312  0.02773344116\nSurin                     0.06699652147 -0.00087318251  0.01612232273\nTak                       0.02038725673 -0.00057672306  0.00440533087\nTrang                     0.00879964494 -0.00055674285  0.01028287975\nTrat                      0.02097512255 -0.00015065121  0.01159839596\nUbon Ratchathani          0.06005136322 -0.00061752391  0.01541759291\nUdon Thani                0.04043400005 -0.00039635734  0.00474559843\nUthai Thani               0.04834655198 -0.00096439423  0.01404602297\nUttaradit                 0.06290286784 -0.00092453752  0.01706965728\nYala                      0.02976267619 -0.00085365356  0.02130795790\nYasothon                  0.07248548039 -0.00103478400  0.01507016045\n                                   Z.Ii Pr.z....E.Ii..\nAmnat Charoen             0.44220816550         0.6583\nAng Thong                 0.42559060009         0.6704\nBangkok                  -0.73216772361         0.4641\nBueng Kan                 0.44226375235         0.6583\nBuriram                   0.42715242646         0.6693\nChachoengsao             -2.96876260231         0.0030\nChainat                   0.51683276920         0.6053\nChaiyaphum                0.30088111946         0.7635\nChanthaburi              -0.55503719283         0.5789\nChiang Mai               -0.34782747363         0.7280\nChiang Rai                0.19471190228         0.8456\nChonburi                 -0.20958343283         0.8340\nChumphon                 -0.17751464598         0.8591\nKalasin                   0.57386478914         0.5661\nKamphaeng Phet            0.53566859548         0.5922\nKanchanaburi             -0.53438898432         0.5931\nKhon Kaen                 0.69763381711         0.4854\nKrabi                     0.04236983376         0.9662\nLampang                   0.12792071369         0.8982\nLamphun                  -0.21919618006         0.8265\nLoei                      0.50428761107         0.6141\nLopburi                   0.60247085905         0.5469\nMae Hong Son             -0.43308981172         0.6649\nMaha Sarakham             0.52981915887         0.5962\nMukdahan                  0.69344573929         0.4880\nNakhon Nayok              0.45152770242         0.6516\nNakhon Pathom            -2.57899148032         0.0099\nNakhon Phanom             0.46303412841         0.6433\nNakhon Ratchasima         0.63328064352         0.5266\nNakhon Sawan              0.74303056745         0.4575\nNakhon Si Thammarat      -0.23774899263         0.8121\nNan                       0.46687779020         0.6406\nNarathiwat                0.38207690115         0.7024\nNong Bua Lamphu           0.30962665227         0.7568\nNong Khai                 0.48472042815         0.6279\nNonthaburi               -3.57076617157         0.0004\nPathum Thani             -2.78339807865         0.0054\nPattani                   0.19658983250         0.8441\nPhang Nga                 0.31952388681         0.7493\nPhatthalung               0.18161088889         0.8559\nPhayao                    0.32109875280         0.7481\nPhetchabun                0.60747438907         0.5435\nPhetchaburi              -0.17044138455         0.8647\nPhichit                   0.45645977698         0.6481\nPhitsanulok               0.62887519637         0.5294\nPhra Nakhon Si Ayutthaya  0.65251083582         0.5141\nPhrae                     0.58399346585         0.5592\nPhuket                              NaN            NaN\nPrachinburi               0.36791590620         0.7129\nPrachuap Khiri Khan      -0.10471467926         0.9166\nRanong                   -0.10219317212         0.9186\nRatchaburi                0.29079505125         0.7712\nRayong                   -1.12507965880         0.2606\nRoi Et                    0.68534808378         0.4931\nSa Kaeo                   0.43063167601         0.6667\nSakon Nakhon              0.62522622775         0.5318\nSamut Prakan             -5.24096436405         0.0000\nSamut Sakhon             -3.50496983019         0.0005\nSamut Songkhram           0.26360257354         0.7921\nSaraburi                  0.39333654998         0.6941\nSatun                     0.16352984708         0.8701\nSing Buri                 0.57134032448         0.5678\nSisaket                   0.52822981910         0.5973\nSongkhla                 -0.50904291159         0.6107\nSukhothai                 0.60658807756         0.5441\nSuphan Buri               0.54908844219         0.5829\nSurat Thani              -0.06626070868         0.9472\nSurin                     0.53451777233         0.5930\nTak                       0.31585260712         0.7521\nTrang                     0.09226794222         0.9265\nTrat                      0.19616144815         0.8445\nUbon Ratchathani          0.48860481380         0.6251\nUdon Thani                0.59270376863         0.5534\nUthai Thani               0.41607023571         0.6774\nUttaradit                 0.48853399479         0.6252\nYala                      0.20974045792         0.8339\nYasothon                  0.59889146247         0.5492\n\n\n\nthai_tourism.localMI &lt;- cbind(thai_tourism,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\n\n\n\ntm_shape(thai_tourism.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\ntm_shape(thai_tourism.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\nSome legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nnci &lt;- moran.plot(thai_tourism$revenue_all, rswm_q,\n                  labels=as.character(thai_tourism$province_eng), \n                  xlab=\"Revenue from Tourist\", \n                  ylab=\"Spatially Lag Revenue from Tourist\")\n\n\n\n\n\n\n\n\nAs seen from the scatter plot, it can be seen that Chonburi, Phuket and Bangkok is way further from the cluster\n\n\n\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\n\nthai_tourism$lag_revenue &lt;- lag.listw(rswm_q, thai_tourism$revenue_all)\nDV &lt;- thai_tourism$lag_revenue - mean(thai_tourism$lag_revenue)     \n\nCentering local Moran around the mean value\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\nSet a statistical significance level\n\nsignif &lt;- 0.05\n\n\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 1 # low low\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2 # high low\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3 # low high\nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4 # high high\n\nThe non significant value of Moran will be placed in category 0\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\n\n\n\nthai_tourism.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(thai_tourism.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\nFrom the LISA Map, we can see that all the provinces surrounding Bangkok is a low-high autocorrelation, which means that all the surrounding provinces are low outlier, whereas Bangkok is a high outlier in terms of revenue from all tourists."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#hot-spot-and-cold-spot-area-analysis",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#hot-spot-and-cold-spot-area-analysis",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "wm_idw &lt;- thai_tourism %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wts = st_inverse_distance(nb, \n                              geometry, \n                              scale = 1,\n                              alpha = 1),\n         .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\n\nHCSA &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    revenue_all, nb, wts, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA\n\nSimple feature collection with 77 features and 24 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 77 × 25\n   gi_star cluster     e_gi   var_gi std_dev p_value p_sim p_folded_sim skewness\n     &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1  -0.533 High     1.25e-6 1.69e-12  -0.703 4.82e-1  0.28         0.14     1.82\n 2   7.45  Low      1.22e-6 1.14e-11   5.28  1.31e-7  0.08         0.04     4.64\n 3   3.49  Low      1.57e-6 8.33e-12   3.04  2.40e-3  0.12         0.06     2.91\n 4   3.05  Low      1.38e-6 6.11e-12   3.11  1.85e-3  0.1          0.05     3.91\n 5  -0.627 Low      1.25e-6 2.07e-12  -0.668 5.04e-1  0.3          0.15     2.32\n 6  -0.387 Low      1.25e-6 4.45e-12  -0.407 6.84e-1  0.98         0.49     3.04\n 7  -0.594 Low      1.03e-6 1.74e-12  -0.538 5.91e-1  0.6          0.3      2.83\n 8  -0.549 Low      1.46e-6 5.35e-12  -0.563 5.73e-1  0.14         0.07     2.59\n 9  -0.509 Low      1.16e-6 3.63e-12  -0.549 5.83e-1  0.16         0.08     3.05\n10  -0.395 Low      7.75e-7 1.38e-12  -0.337 7.36e-1  1            0.5      3.10\n# ℹ 67 more rows\n# ℹ 16 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, Shape_Leng &lt;dbl&gt;,\n#   Shape_Area &lt;dbl&gt;, province_eng &lt;chr&gt;, revenue_all &lt;dbl&gt;,\n#   revenue_thai &lt;dbl&gt;, revenue_foreign &lt;dbl&gt;, no_tourist_stay &lt;dbl&gt;,\n#   no_tourist_all &lt;dbl&gt;, no_tourist_thai &lt;dbl&gt;, no_tourist_foreign &lt;dbl&gt;,\n#   ratio_tourist_stay &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;, lag_revenue &lt;dbl&gt;\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\nHCSA_sig &lt;- HCSA  %&gt;%\n  filter(p_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig) +\n  tm_fill(\"cluster\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n\nFindings: There is no hotspot area in the plot above and there are coldspots identified in Ubon-Ratchathani, Yasothon, Roi Et and Mukdahan provinces."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#correlation-analysis",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#correlation-analysis",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "cluster_vars.cor = cor(tourism_data[,2:9])\ncorrplot.mixed(cluster_vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n\n\n\n\n\n\n\n\nFrom the correlation analysis, there is an interesting finding. Overall revenue are strongly correlated with number of foreign tourist, but it’s less stronger with the number of thai tourists. This may be due to foreign tourists contributing more revenue and spending more money as compared to local tourists."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#emerging-hotspot-analysis",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#emerging-hotspot-analysis",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "Let us create a time series cube based on the revenue generated from tourism in Thailand\n\ntourism_revenue &lt;- tourism %&gt;%\n  filter(variable %in% c(\"revenue_all\"))\n\n\ntourism_revenue &lt;- left_join(boundary, tourism_revenue, by = c(\"province_eng\"))\n\nDerive a dataframe grouped by the year and province in Thailand\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  group_by(year, province_eng, geometry) %&gt;%\n  summarize(value = sum(value, na.rm = TRUE),\n            variable = first(variable))\n\n`summarise()` has grouped output by 'year', 'province_eng'. You can override\nusing the `.groups` argument.\n\n\n\ntourism_revenue &lt;- tourism_revenue %&gt;%\n  pivot_wider(names_from = variable, values_from = value)\n\n\ntourism_st &lt;- spacetime(tourism_revenue, boundary,\n                      .loc_col = \"province_eng\",\n                      .time_col = \"year\")\n\n\nis_spacetime_cube(tourism_st)\n\n[1] TRUE\n\n\n\n\n\n\n\n\ntourism_nb &lt;- tourism_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb, \n                             geometry, \n                             scale = 1,\n                             alpha = 1),\n    .before = 1) %&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\n\n\n\n\ngi_stars &lt;- tourism_nb %&gt;% \n  group_by(year) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    revenue_all, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\n\ngi_stars\n\nSimple feature collection with 385 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 385 × 16\n# Groups:   year [5]\n    year province_eng                   geometry revenue_all nb    wt    gi_star\n   &lt;dbl&gt; &lt;chr&gt;                &lt;MULTIPOLYGON [m]&gt;       &lt;dbl&gt; &lt;lis&gt; &lt;lis&gt;   &lt;dbl&gt;\n 1  2019 Bangkok       (((674339.8 1543300, 674…     1.07e12 &lt;int&gt; &lt;dbl&gt;   5.24 \n 2  2019 Samut Prakan  (((687139.8 1517113, 687…     7.01e 9 &lt;int&gt; &lt;dbl&gt;   3.62 \n 3  2019 Nonthaburi    (((644817.9 1559286, 644…     4.66e 9 &lt;int&gt; &lt;dbl&gt;   2.83 \n 4  2019 Pathum Thani  (((704086 1575736, 70408…     3.47e 9 &lt;int&gt; &lt;dbl&gt;   2.33 \n 5  2019 Phra Nakhon … (((662941.6 1620856, 662…     1.92e10 &lt;int&gt; &lt;dbl&gt;  -0.653\n 6  2019 Ang Thong     (((643472.8 1636469, 643…     1.01e 9 &lt;int&gt; &lt;dbl&gt;  -0.568\n 7  2019 Lopburi       (((751293.3 1742960, 751…     5.75e 9 &lt;int&gt; &lt;dbl&gt;  -0.699\n 8  2019 Sing Buri     (((647136.1 1668671, 647…     8.78e 8 &lt;int&gt; &lt;dbl&gt;  -0.675\n 9  2019 Chainat       (((620165.4 1704256, 620…     1.34e 9 &lt;int&gt; &lt;dbl&gt;  -0.628\n10  2019 Saraburi      (((757935.1 1667886, 757…     6.81e 9 &lt;int&gt; &lt;dbl&gt;  -0.513\n# ℹ 375 more rows\n# ℹ 9 more variables: cluster &lt;fct&gt;, e_gi &lt;dbl&gt;, var_gi &lt;dbl&gt;, std_dev &lt;dbl&gt;,\n#   p_value &lt;dbl&gt;, p_sim &lt;dbl&gt;, p_folded_sim &lt;dbl&gt;, skewness &lt;dbl&gt;,\n#   kurtosis &lt;dbl&gt;\n\n\n\n\n\n\n\n\nH0: There is no monotonic trend over time\nH1: Monotonic trend is present\nReject null hypothesis if the p-value is smaller than alpha value\nTau range interpretation:\n\n-1 = perfectly decreasing series\n1 = perfectly increasing series\n\n\n\n\nLet us choose Bangkok to analyze as Bangkok has the highest revenue from tourism\n\ncbg &lt;- gi_stars %&gt;% \n  ungroup() %&gt;% \n  filter(province_eng == \"Bangkok\") |&gt; \n  select(province_eng, year, gi_star)\n\n\nggplot(data = cbg, \n       aes(x = year, \n           y = gi_star)) +\n  geom_line() +\n  theme_light()\n\n\n\n\n\n\n\n\nFindings:\n\nFrom 2019 to 2022, the Gi* value decreases, which indicates that there is an increasing trend towards cold spots during this period of time\nFrom 2022 to 2023, the Gi* value increases, which indicates that the spatial clustering increases towards hot spots in this period\n\n\ncbg %&gt;%\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr::unnest_wider(mk)\n\n# A tibble: 1 × 6\n     tau    sl     S     D  varS                                        geometry\n   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                              &lt;MULTIPOLYGON [m]&gt;\n1 -0.600 0.221    -6    10  16.7 (((674339.8 1543300, 674382.3 1543278, 674448.…\n\n\nThe p-value is 0.22, we do not reject null hypothesis and conclude that there is no monotonic trend (Bangkok)\nWe can see the overall result per province using the following code\n\nehsa &lt;- gi_stars %&gt;%\n  group_by(province_eng) %&gt;%\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mk)\nhead(ehsa)\n\n# A tibble: 6 × 7\n  province_eng     tau    sl     S     D  varS                          geometry\n  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                &lt;MULTIPOLYGON [m]&gt;\n1 Amnat Charoen  0     1         0    10  16.7 (((1137720 1809629, 1137724 1809…\n2 Ang Thong      0.400 0.462     4    10  16.7 (((643472.8 1636469, 643496 1636…\n3 Bangkok       -0.600 0.221    -6    10  16.7 (((674339.8 1543300, 674382.3 15…\n4 Bueng Kan      0.200 0.806     2    10  16.7 (((965496 2045531, 965625.5 2045…\n5 Buriram       -0.200 0.806    -2    10  16.7 (((921217 1750212, 921217 175021…\n6 Chachoengsao  -0.200 0.806    -2    10  16.7 (((722656.1 1546054, 722796 1546…\n\n\n\nehsa_desc &lt;- ehsa %&gt;%\n  arrange(desc(tau))\n\nhead(ehsa_desc)\n\n# A tibble: 6 × 7\n  province_eng            tau     sl     S     D  varS                  geometry\n  &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;MULTIPOLYGON [m]&gt;\n1 Phra Nakhon Si Ayutt… 0.800 0.0864     8    10  16.7 (((662941.6 1620856, 662…\n2 Phayao                0.600 0.221      6    10  16.7 (((648755.2 2182064, 648…\n3 Uthai Thani           0.600 0.221      6    10  16.7 (((514892 1746436, 51490…\n4 Ang Thong             0.400 0.462      4    10  16.7 (((643472.8 1636469, 643…\n5 Loei                  0.400 0.462      4    10  16.7 (((827375.5 2016969, 827…\n6 Phetchabun            0.400 0.462      4    10  16.7 (((755146.4 1900816, 755…\n\n\nFindings: The shown sorted table is based on the Tau range, which shows that the value shown has increasing trend. The consistent growth indicates that there is potential growth in tourism revenue in these provinces.\n\nehsa_asc &lt;- ehsa %&gt;%\n  arrange(tau)\n\nhead(ehsa_asc)\n\n# A tibble: 6 × 7\n  province_eng           tau     sl     S     D  varS                   geometry\n  &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;MULTIPOLYGON [m]&gt;\n1 Krabi               -0.800 0.0864    -8    10  16.7 (((512499 827838.6, 51250…\n2 Nakhon Si Thammarat -0.800 0.0864    -8    10  16.7 (((585074.4 1029631, 5850…\n3 Phang Nga           -0.800 0.0864    -8    10  16.7 (((457515.4 856050.4, 457…\n4 Trang               -0.800 0.0864    -8    10  16.7 (((552555.6 770748.6, 552…\n5 Bangkok             -0.600 0.221     -6    10  16.7 (((674339.8 1543300, 6743…\n6 Nonthaburi          -0.600 0.221     -6    10  16.7 (((644817.9 1559286, 6448…\n\n\nFindings: The provinces shown in above table indicates that those are the provinces with decreasing series. It is interesting to find that Bangkok is part of the top 5 decreasing series even though Bangkok has the highest revenue in tourism. This indicates that the tourism sector should pay more attention to these provinces and avoid decreasing trend."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#conclusion",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#conclusion",
    "title": "Take-home Exercise 2",
    "section": "",
    "text": "From the analysis, we can find that Bangkok area has a lot of tourism activity, but it doesnt show monotonic trend over time, which indicates that it is not an increasing trend and it fluctuates randomly over time. Under the hotspot and coldspot analysis, we can find that the Ubon-Ratchathani, Yasothon, Roi Et and Mukdahan provinces are considered as cold spots. This might indicate that these provinces lack of tourism infrastructure. It is a potential area for the Thailand tourism sector to pay more attention to and drive tourism traffic to the cold spots area and maintain stability of tourism activity in Bangkok area."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#load-and-install-r-packages",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#load-and-install-r-packages",
    "title": "Hands-on Exercise 7",
    "section": "1.1 Load and Install R Packages",
    "text": "1.1 Load and Install R Packages\n\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#geospatial-data-wrangling",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#geospatial-data-wrangling",
    "title": "Hands-on Exercise 7",
    "section": "1.2 Geospatial Data Wrangling",
    "text": "1.2 Geospatial Data Wrangling\n\n1.2.1 Importing Data\n\nmpsz = st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\brigittatsai\\ISSS626_AY2024-25_T1\\Hands-on_Ex\\Hands-on_Ex07\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n\n1.2.2 Updating CRS\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)\n\n\nst_crs(mpsz_svy21)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nst_bbox(mpsz_svy21) #view extent\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#aspatial-data-wrangling",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#aspatial-data-wrangling",
    "title": "Hands-on Exercise 7",
    "section": "1.3 Aspatial Data Wrangling",
    "text": "1.3 Aspatial Data Wrangling\n\n1.3.1 Importing Data\n\ncondo_resale = read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n\n\nhead(condo_resale$LONGITUDE) #see the data in XCOORD column\n\n[1] 103.7802 103.8123 103.7971 103.8247 103.9505 103.9386\n\n\n\nhead(condo_resale$LATITUDE) #see the data in YCOORD column\n\n[1] 1.287145 1.328698 1.313727 1.308563 1.321437 1.314198\n\n\n\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05351   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_Of_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151710   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\n\n\n1.3.2 Converting Aspatial Data into an sf Object\n\ncondo_resale.sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs=4326) %&gt;%\n  st_transform(crs=3414)\n\n\nhead(condo_resale.sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_Of_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#eda-using-statistical-graphics",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#eda-using-statistical-graphics",
    "title": "Hands-on Exercise 7",
    "section": "2.1 EDA using Statistical Graphics",
    "text": "2.1 EDA using Statistical Graphics\n\nggplot(data=condo_resale.sf, aes(x=`SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\n\n\n\n\nThe chart above shows right-skewed distribution, which means that more condominium units are being transacted at lower price\n\ncondo_resale.sf &lt;- condo_resale.sf %&gt;%\n  mutate(`LOG_SELLING_PRICE` = log(SELLING_PRICE))\n\n\nggplot(data=condo_resale.sf, aes(x=`LOG_SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#multiple-histogram-plot-distribution",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#multiple-histogram-plot-distribution",
    "title": "Hands-on Exercise 7",
    "section": "2.2 Multiple Histogram Plot Distribution",
    "text": "2.2 Multiple Histogram Plot Distribution\n\nAREA_SQM &lt;- ggplot(data=condo_resale.sf, aes(x= `AREA_SQM`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nAGE &lt;- ggplot(data=condo_resale.sf, aes(x= `AGE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CBD &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CBD`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CHILDCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CHILDCARE`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_ELDERLYCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_ELDERLYCARE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_URA_GROWTH_AREA &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_URA_GROWTH_AREA`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_HAWKER_MARKET &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_HAWKER_MARKET`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_KINDERGARTEN &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_KINDERGARTEN`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_MRT &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_MRT`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PARK &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PARK`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_TOP_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_TOP_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nggarrange(AREA_SQM, AGE, PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, \n          PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN, PROX_MRT,\n          PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH,  \n          ncol = 3, nrow = 4)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#drawing-statistical-point-map",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#drawing-statistical-point-map",
    "title": "Hands-on Exercise 7",
    "section": "2.3 Drawing Statistical Point Map",
    "text": "2.3 Drawing Statistical Point Map\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz_svy21)+\n  tm_polygons() + \ntm_shape(condo_resale.sf) +  \n  tm_dots(col = \"SELLING_PRICE\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#simple-linear-regression-method",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#simple-linear-regression-method",
    "title": "Hands-on Exercise 7",
    "section": "3.1 Simple Linear Regression Method",
    "text": "3.1 Simple Linear Regression Method\n\ncondo.slr &lt;- lm(formula=SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\n\nsummary(condo.slr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n\n\nggplot(data=condo_resale.sf,  \n       aes(x=`AREA_SQM`, y=`SELLING_PRICE`)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe figure above reveals that there are a few statistical outliers with relatively high selling prices"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#multiple-linear-regression-method",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#multiple-linear-regression-method",
    "title": "Hands-on Exercise 7",
    "section": "3.2 Multiple Linear Regression Method",
    "text": "3.2 Multiple Linear Regression Method\n\n3.2.1 Visualising the Relationship of the Independent Variables\nPlot correlation matrix\n\ncorrplot(cor(condo_resale[, 5:23]), diag = FALSE, order = \"AOE\",\n         tl.pos = \"td\", tl.cex = 0.5, method = \"number\", type = \"upper\")\n\n\n\n\n\n\n\n\n\n\n3.2.2 Building a hedonic pricing model using multiple linear regression\n\ncondo.mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE    + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n                  PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                data=condo_resale.sf)\nsummary(condo.mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3475964  -293923   -23069   241043 12260381 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           481728.40  121441.01   3.967 7.65e-05 ***\nAREA_SQM               12708.32     369.59  34.385  &lt; 2e-16 ***\nAGE                   -24440.82    2763.16  -8.845  &lt; 2e-16 ***\nPROX_CBD              -78669.78    6768.97 -11.622  &lt; 2e-16 ***\nPROX_CHILDCARE       -351617.91  109467.25  -3.212  0.00135 ** \nPROX_ELDERLYCARE      171029.42   42110.51   4.061 5.14e-05 ***\nPROX_URA_GROWTH_AREA   38474.53   12523.57   3.072  0.00217 ** \nPROX_HAWKER_MARKET     23746.10   29299.76   0.810  0.41782    \nPROX_KINDERGARTEN     147468.99   82668.87   1.784  0.07466 .  \nPROX_MRT             -314599.68   57947.44  -5.429 6.66e-08 ***\nPROX_PARK             563280.50   66551.68   8.464  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      180186.08   65237.95   2.762  0.00582 ** \nPROX_TOP_PRIMARY_SCH    2280.04   20410.43   0.112  0.91107    \nPROX_SHOPPING_MALL   -206604.06   42840.60  -4.823 1.57e-06 ***\nPROX_SUPERMARKET      -44991.80   77082.64  -0.584  0.55953    \nPROX_BUS_STOP         683121.35  138353.28   4.938 8.85e-07 ***\nNO_Of_UNITS             -231.18      89.03  -2.597  0.00951 ** \nFAMILY_FRIENDLY       140340.77   47020.55   2.985  0.00289 ** \nFREEHOLD              359913.01   49220.22   7.312 4.38e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1417 degrees of freedom\nMultiple R-squared:  0.6518,    Adjusted R-squared:  0.6474 \nF-statistic: 147.4 on 18 and 1417 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n3.2.3 Preparing Publication Quality Table: olsrr Method\n\ncondo.mlr1 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT  + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL    + PROX_BUS_STOP + \n                   NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD,\n                 data=condo_resale.sf)\nols_regress(condo.mlr1)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.591 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n-----------------------------------------------------------------------------------------------------------------\n\n\n\n\n3.2.4 Preparing Publication Quality Table: gtsummary Method\n\ntbl_regression(condo.mlr1, intercept = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI\n1\np-value\n\n\n\n\n(Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n\n\nAREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n\n\nAGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n\n\nPROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n\n\nPROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n\n\nPROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n\n\nPROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n\n\nPROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n\n\nPROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n\n\nPROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n\n\nPROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n\n\nPROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n\n\nNO_Of_UNITS\n-245\n-418, -73\n0.005\n\n\nFAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n\n\nFREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n\n\n\n1\nCI = Confidence Interval\n\n\n\n\n\n\n\n\n\ntbl_regression(condo.mlr1, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n\n\n\n  \n    \n      Characteristic\n\n      Beta\n\n      95% CI\n1\n      p-value\n\n    \n  \n  \n    (Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n    AREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n    AGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n    PROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n    PROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n    PROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n    PROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n    PROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n    PROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n    PROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n    PROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n    PROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n    NO_Of_UNITS\n-245\n-418, -73\n0.005\n    FAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n    FREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n  \n  \n    \n      R² = 0.651; Adjusted R² = 0.647; AIC = 42,967; Statistic = 189; p-value = &lt;0.001; σ = 755,957\n\n    \n  \n  \n    \n      1 CI = Confidence Interval\n\n    \n  \n\n\n\n\n\n\n3.2.5 Checking Multicolinearity\n\nols_vif_tol(condo.mlr1)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_Of_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\n\n\n3.2.6 Test for Non-Linearity\n\nols_plot_resid_fit(condo.mlr1)\n\n\n\n\n\n\n\n\n\n\n3.2.7 Test for Normality Assumption\n\nols_plot_resid_hist(condo.mlr1)\n\n\n\n\n\n\n\n\n\nols_test_normality(condo.mlr1)\n\nWarning in ks.test.default(y, \"pnorm\", mean(y), sd(y)): ties should not be\npresent for the one-sample Kolmogorov-Smirnov test\n\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n\n\n\n3.2.8 Testing for Spatial Autocorrelation\n\nmlr.output &lt;- as.data.frame(condo.mlr1$residuals)\n\n\ncondo_resale.res.sf &lt;- cbind(condo_resale.sf, \n                        condo.mlr1$residuals) %&gt;%\nrename(`MLR_RES` = `condo.mlr1.residuals`)\n\nData Conversion Process\n\ncondo_resale.sp &lt;- as_Spatial(condo_resale.res.sf)\ncondo_resale.sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1436 \nextent      : 14940.85, 43352.45, 24765.67, 48382.81  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 23\nnames       : POSTCODE, SELLING_PRICE, AREA_SQM, AGE,    PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN,    PROX_MRT,   PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH, PROX_SHOPPING_MALL, ... \nmin values  :    18965,        540000,       34,   0, 0.386916393,    0.004927023,      0.054508623,          0.214539508,        0.051817113,       0.004927023, 0.052779424, 0.029064164,      0.077106132,          0.077106132,                  0, ... \nmax values  :   828833,       1.8e+07,      619,  37, 19.18042832,     3.46572633,      3.949157205,           9.15540001,        5.374348075,       2.229045366,  3.48037319,  2.16104919,      3.928989144,          6.748192062,        3.477433767, ... \n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\ntm_shape(mpsz_svy21)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale.res.sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nCompute distance-based weight matrix\n\nnb &lt;- dnearneigh(coordinates(condo_resale.sp), 0, 1500, longlat = FALSE)\nsummary(nb)\n\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\n\n\nnb_lw &lt;- nb2listw(nb, style = 'W')\nsummary(nb_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\nWeights style: W \nWeights constants summary:\n     n      nn   S0       S1       S2\nW 1436 2062096 1436 94.81916 5798.341\n\n\nPerform Moran’s I test\n\nlm.morantest(condo.mlr1, nb_lw)\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD +\nPROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT +\nPROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP +\nNO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, data = condo_resale.sf)\nweights: nb_lw\n\nMoran I statistic standard deviate = 24.366, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nObserved Moran I      Expectation         Variance \n    1.438876e-01    -5.487594e-03     3.758259e-05"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#building-hedonic-pricing-model-using-gwmodel",
    "href": "Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html#building-hedonic-pricing-model-using-gwmodel",
    "title": "Hands-on Exercise 7",
    "section": "3.3 Building Hedonic Pricing Model using GWmodel",
    "text": "3.3 Building Hedonic Pricing Model using GWmodel\n\n3.3.1 Building Fixed Bandwidth GWR Model\nComputing fixed bandwidth\n\nbw.fixed &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                     PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                     PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                     PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                     FAMILY_FRIENDLY + FREEHOLD, \n                   data=condo_resale.sp, \n                   approach=\"CV\", \n                   kernel=\"gaussian\", \n                   adaptive=FALSE, \n                   longlat=FALSE)\n\nFixed bandwidth: 17660.96 CV score: 8.259118e+14 \nFixed bandwidth: 10917.26 CV score: 7.970454e+14 \nFixed bandwidth: 6749.419 CV score: 7.273273e+14 \nFixed bandwidth: 4173.553 CV score: 6.300006e+14 \nFixed bandwidth: 2581.58 CV score: 5.404958e+14 \nFixed bandwidth: 1597.687 CV score: 4.857515e+14 \nFixed bandwidth: 989.6077 CV score: 4.722431e+14 \nFixed bandwidth: 613.7939 CV score: 1.378294e+16 \nFixed bandwidth: 1221.873 CV score: 4.778717e+14 \nFixed bandwidth: 846.0596 CV score: 4.791629e+14 \nFixed bandwidth: 1078.325 CV score: 4.751406e+14 \nFixed bandwidth: 934.7772 CV score: 4.72518e+14 \nFixed bandwidth: 1023.495 CV score: 4.730305e+14 \nFixed bandwidth: 968.6643 CV score: 4.721317e+14 \nFixed bandwidth: 955.7206 CV score: 4.722072e+14 \nFixed bandwidth: 976.6639 CV score: 4.721387e+14 \nFixed bandwidth: 963.7202 CV score: 4.721484e+14 \nFixed bandwidth: 971.7199 CV score: 4.721293e+14 \nFixed bandwidth: 973.6083 CV score: 4.721309e+14 \nFixed bandwidth: 970.5527 CV score: 4.721295e+14 \nFixed bandwidth: 972.4412 CV score: 4.721296e+14 \nFixed bandwidth: 971.2741 CV score: 4.721292e+14 \nFixed bandwidth: 970.9985 CV score: 4.721293e+14 \nFixed bandwidth: 971.4443 CV score: 4.721292e+14 \nFixed bandwidth: 971.5496 CV score: 4.721293e+14 \nFixed bandwidth: 971.3793 CV score: 4.721292e+14 \nFixed bandwidth: 971.3391 CV score: 4.721292e+14 \nFixed bandwidth: 971.3143 CV score: 4.721292e+14 \nFixed bandwidth: 971.3545 CV score: 4.721292e+14 \nFixed bandwidth: 971.3296 CV score: 4.721292e+14 \nFixed bandwidth: 971.345 CV score: 4.721292e+14 \nFixed bandwidth: 971.3355 CV score: 4.721292e+14 \nFixed bandwidth: 971.3413 CV score: 4.721292e+14 \nFixed bandwidth: 971.3377 CV score: 4.721292e+14 \nFixed bandwidth: 971.34 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.3403 CV score: 4.721292e+14 \nFixed bandwidth: 971.3406 CV score: 4.721292e+14 \nFixed bandwidth: 971.3404 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \n\n\n\ngwr.fixed &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                         PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                         PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                         PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                         FAMILY_FRIENDLY + FREEHOLD, \n                       data=condo_resale.sp, \n                       bw=bw.fixed, \n                       kernel = 'gaussian', \n                       longlat = FALSE)\n\n\ngwr.fixed\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-14 21:11:44.147722 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3405 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4646e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9007e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5207e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793548\n   AREA_SQM                 21575\n   AGE                     434201\n   PROX_CBD               2704596\n   PROX_CHILDCARE         1654087\n   PROX_ELDERLYCARE      38867814\n   PROX_URA_GROWTH_AREA  78515730\n   PROX_MRT               3124316\n   PROX_PARK             18122425\n   PROX_PRIMARY_SCH       4637503\n   PROX_SHOPPING_MALL     1529952\n   PROX_BUS_STOP         11342182\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073636\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3804 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6196 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.53407e+14 \n   R-square value:  0.8909912 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2024-10-14 21:11:46.395451 \n\n\n\n\n3.3.2 Building Adaptive Bandiwidth with GWR Model\n\nbw.adaptive &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_SHOPPING_MALL   + PROX_BUS_STOP + \n                        NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                      data=condo_resale.sp, \n                      approach=\"CV\", \n                      kernel=\"gaussian\", \n                      adaptive=TRUE, \n                      longlat=FALSE)\n\nAdaptive bandwidth: 895 CV score: 7.952401e+14 \nAdaptive bandwidth: 561 CV score: 7.667364e+14 \nAdaptive bandwidth: 354 CV score: 6.953454e+14 \nAdaptive bandwidth: 226 CV score: 6.15223e+14 \nAdaptive bandwidth: 147 CV score: 5.674373e+14 \nAdaptive bandwidth: 98 CV score: 5.426745e+14 \nAdaptive bandwidth: 68 CV score: 5.168117e+14 \nAdaptive bandwidth: 49 CV score: 4.859631e+14 \nAdaptive bandwidth: 37 CV score: 4.646518e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \nAdaptive bandwidth: 25 CV score: 4.430816e+14 \nAdaptive bandwidth: 32 CV score: 4.505602e+14 \nAdaptive bandwidth: 27 CV score: 4.462172e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \n\n\nConstructing the adaptive bandwidth model\n\ngwr.adaptive &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                            NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale.sp, bw=bw.adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE, \n                          longlat = FALSE)\n\n\ngwr.adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-14 21:12:03.68141 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 30 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -1.3487e+08 -2.4669e+05  7.7928e+05  1.6194e+06\n   AREA_SQM              3.3188e+03  5.6285e+03  7.7825e+03  1.2738e+04\n   AGE                  -9.6746e+04 -2.9288e+04 -1.4043e+04 -5.6119e+03\n   PROX_CBD             -2.5330e+06 -1.6256e+05 -7.7242e+04  2.6624e+03\n   PROX_CHILDCARE       -1.2790e+06 -2.0175e+05  8.7158e+03  3.7778e+05\n   PROX_ELDERLYCARE     -1.6212e+06 -9.2050e+04  6.1029e+04  2.8184e+05\n   PROX_URA_GROWTH_AREA -7.2686e+06 -3.0350e+04  4.5869e+04  2.4613e+05\n   PROX_MRT             -4.3781e+07 -6.7282e+05 -2.2115e+05 -7.4593e+04\n   PROX_PARK            -2.9020e+06 -1.6782e+05  1.1601e+05  4.6572e+05\n   PROX_PRIMARY_SCH     -8.6418e+05 -1.6627e+05 -7.7853e+03  4.3222e+05\n   PROX_SHOPPING_MALL   -1.8272e+06 -1.3175e+05 -1.4049e+04  1.3799e+05\n   PROX_BUS_STOP        -2.0579e+06 -7.1461e+04  4.1104e+05  1.2071e+06\n   NO_Of_UNITS          -2.1993e+03 -2.3685e+02 -3.4699e+01  1.1657e+02\n   FAMILY_FRIENDLY      -5.9879e+05 -5.0927e+04  2.6173e+04  2.2481e+05\n   FREEHOLD             -1.6340e+05  4.0765e+04  1.9023e+05  3.7960e+05\n                            Max.\n   Intercept            18758355\n   AREA_SQM                23064\n   AGE                     13303\n   PROX_CBD             11346650\n   PROX_CHILDCARE        2892127\n   PROX_ELDERLYCARE      2465671\n   PROX_URA_GROWTH_AREA  7384059\n   PROX_MRT              1186242\n   PROX_PARK             2588497\n   PROX_PRIMARY_SCH      3381462\n   PROX_SHOPPING_MALL   38038564\n   PROX_BUS_STOP        12081592\n   NO_Of_UNITS              1010\n   FAMILY_FRIENDLY       2072414\n   FREEHOLD              1813995\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 350.3088 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1085.691 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41982.22 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41546.74 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 41914.08 \n   Residual sum of squares: 2.528227e+14 \n   R-square value:  0.8912425 \n   Adjusted R-square value:  0.8561185 \n\n   ***********************************************************************\n   Program stops at: 2024-10-14 21:12:06.565429 \n\n\n\n\n3.3.3 Visualising GWR Output\nIn addition to regression residuals, the output feature class table includes fields for observed and predicted y values, condition number (cond), Local R2, residuals, and explanatory variable coefficients and standard errors:\n\nCondition Number: this diagnostic evaluates local collinearity. In the presence of strong local collinearity, results become unstable. Results associated with condition numbers larger than 30, may be unreliable.\nLocal R2: these values range between 0.0 and 1.0 and indicate how well the local regression model fits observed y values. Very low values indicate the local model is performing poorly. Mapping the Local R2 values to see where GWR predicts well and where it predicts poorly may provide clues about important variables that may be missing from the regression model.\nPredicted: these are the estimated (or fitted) y values 3. computed by GWR.\nResiduals: to obtain the residual values, the fitted y values are subtracted from the observed y values. Standardized residuals have a mean of zero and a standard deviation of 1. A cold-to-hot rendered map of standardized residuals can be produce by using these values.\nCoefficient Standard Error: these values measure the reliability of each coefficient estimate. Confidence in those estimates are higher when standard errors are small in relation to the actual coefficient values. Large standard errors may indicate problems with local collinearity.\n\n\n\n3.3.4 Converting SDF into sf dataframe\n\ncondo_resale.sf.adaptive &lt;- st_as_sf(gwr.adaptive$SDF) %&gt;%\n  st_transform(crs=3414)\n\n\ncondo_resale.sf.adaptive.svy21 &lt;- st_transform(condo_resale.sf.adaptive, 3414)\ncondo_resale.sf.adaptive.svy21  \n\nSimple feature collection with 1436 features and 51 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14940.85 ymin: 24765.67 xmax: 43352.45 ymax: 48382.81\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n    Intercept  AREA_SQM        AGE  PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n1   2050011.7  9561.892  -9514.634 -120681.9      319266.92       -393417.79\n2   1633128.2 16576.853 -58185.479 -149434.2      441102.18        325188.74\n3   3433608.2 13091.861 -26707.386 -259397.8     -120116.82        535855.81\n4    234358.9 20730.601 -93308.988 2426853.7      480825.28        314783.72\n5   2285804.9  6722.836 -17608.018 -316835.5       90764.78       -137384.61\n6  -3568877.4  6039.581 -26535.592  327306.1     -152531.19       -700392.85\n7  -2874842.4 16843.575 -59166.727 -983577.2     -177810.50       -122384.02\n8   2038086.0  6905.135 -17681.897 -285076.6       70259.40        -96012.78\n9   1718478.4  9580.703 -14401.128  105803.4     -657698.02       -123276.00\n10  3457054.0 14072.011 -31579.884 -234895.4       79961.45        548581.04\n   PROX_URA_GROWTH_AREA    PROX_MRT  PROX_PARK PROX_PRIMARY_SCH\n1            -159980.20  -299742.96 -172104.47        242668.03\n2            -142290.39 -2510522.23  523379.72       1106830.66\n3            -253621.21  -936853.28  209099.85        571462.33\n4           -2679297.89 -2039479.50 -759153.26       3127477.21\n5             303714.81   -44567.05  -10284.62         30413.56\n6             -28051.25   733566.47 1511488.92        320878.23\n7            1397676.38 -2745430.34  710114.74       1786570.95\n8             269368.71   -14552.99   73533.34         53359.73\n9            -361974.72  -476785.32 -132067.59        -40128.92\n10           -150024.38 -1503835.53  574155.47        108996.67\n   PROX_SHOPPING_MALL PROX_BUS_STOP  NO_Of_UNITS FAMILY_FRIENDLY  FREEHOLD\n1          300881.390     1210615.4  104.8290640       -9075.370  303955.6\n2          -87693.378     1843587.2 -288.3441183      310074.664  396221.3\n3         -126732.712     1411924.9   -9.5532945        5949.746  168821.7\n4          -29593.342     7225577.5 -161.3551620     1556178.531 1212515.6\n5           -7490.586      677577.0   42.2659674       58986.951  328175.2\n6          258583.881     1086012.6 -214.3671271      201992.641  471873.1\n7         -384251.210     5094060.5   -0.9212521      359659.512  408871.9\n8          -39634.902      735767.1   30.1741069       55602.506  347075.0\n9          276718.757     2815772.4  675.1615559      -30453.297  503872.8\n10        -454726.822     2123557.0  -21.3044311     -100935.586  213324.6\n         y    yhat    residual CV_Score Stud_residual Intercept_SE AREA_SQM_SE\n1  3000000 2886532   113468.16        0    0.38207013     516105.5    823.2860\n2  3880000 3466801   413198.52        0    1.01433140     488083.5    825.2380\n3  3325000 3616527  -291527.20        0   -0.83780678     963711.4    988.2240\n4  4250000 5435482 -1185481.63        0   -2.84614670     444185.5    617.4007\n5  1400000 1388166    11834.26        0    0.03404453    2119620.6   1376.2778\n6  1320000 1516702  -196701.94        0   -0.72065800   28572883.7   2348.0091\n7  3410000 3266881   143118.77        0    0.41291992     679546.6    893.5893\n8  1420000 1431955   -11955.27        0   -0.03033109    2217773.1   1415.2604\n9  2025000 1832799   192200.83        0    0.52018109     814281.8    943.8434\n10 2550000 2223364   326635.53        0    1.10559735    2410252.0   1271.4073\n      AGE_SE PROX_CBD_SE PROX_CHILDCARE_SE PROX_ELDERLYCARE_SE\n1   5889.782    37411.22          319111.1           120633.34\n2   6226.916    23615.06          299705.3            84546.69\n3   6510.236    56103.77          349128.5           129687.07\n4   6010.511   469337.41          304965.2           127150.69\n5   8180.361   410644.47          698720.6           327371.55\n6  14601.909  5272846.47         1141599.8          1653002.19\n7   8970.629   346164.20          530101.1           148598.71\n8   8661.309   438035.69          742532.8           399221.05\n9  11791.208    89148.35          704630.7           329683.30\n10  9941.980   173532.77          500976.2           281876.74\n   PROX_URA_GROWTH_AREA_SE PROX_MRT_SE PROX_PARK_SE PROX_PRIMARY_SCH_SE\n1                 56207.39    185181.3     205499.6            152400.7\n2                 76956.50    281133.9     229358.7            165150.7\n3                 95774.60    275483.7     314124.3            196662.6\n4                470762.12    279877.1     227249.4            240878.9\n5                474339.56    363830.0     364580.9            249087.7\n6               5496627.21    730453.2    1741712.0            683265.5\n7                371692.97    375511.9     297400.9            344602.8\n8                517977.91    423155.4     440984.4            261251.2\n9                153436.22    285325.4     304998.4            278258.5\n10               239182.57    571355.7     599131.8            331284.8\n   PROX_SHOPPING_MALL_SE PROX_BUS_STOP_SE NO_Of_UNITS_SE FAMILY_FRIENDLY_SE\n1               109268.8         600668.6       218.1258           131474.7\n2                98906.8         410222.1       208.9410           114989.1\n3               119913.3         464156.7       210.9828           146607.2\n4               177104.1         562810.8       361.7767           108726.6\n5               301032.9         740922.4       299.5034           160663.7\n6              2931208.6        1418333.3       602.5571           331727.0\n7               249969.5         821236.4       532.1978           129241.2\n8               351634.0         775038.4       338.6777           171895.1\n9               289872.7         850095.5       439.9037           220223.4\n10              265529.7         631399.2       259.0169           189125.5\n   FREEHOLD_SE Intercept_TV AREA_SQM_TV     AGE_TV PROX_CBD_TV\n1     115954.0    3.9720784   11.614302  -1.615447 -3.22582173\n2     130110.0    3.3460017   20.087361  -9.344188 -6.32792021\n3     141031.5    3.5629010   13.247868  -4.102368 -4.62353528\n4     138239.1    0.5276150   33.577223 -15.524302  5.17080808\n5     210641.1    1.0784029    4.884795  -2.152474 -0.77155660\n6     374347.3   -0.1249043    2.572214  -1.817269  0.06207388\n7     182216.9   -4.2305303   18.849348  -6.595605 -2.84136028\n8     216649.4    0.9189786    4.879056  -2.041481 -0.65080678\n9     220473.7    2.1104224   10.150733  -1.221345  1.18682383\n10    206346.2    1.4343123   11.068059  -3.176418 -1.35360852\n   PROX_CHILDCARE_TV PROX_ELDERLYCARE_TV PROX_URA_GROWTH_AREA_TV PROX_MRT_TV\n1         1.00048819          -3.2612693            -2.846248368 -1.61864578\n2         1.47178634           3.8462625            -1.848971738 -8.92998600\n3        -0.34404755           4.1319138            -2.648105057 -3.40075727\n4         1.57665606           2.4756745            -5.691404992 -7.28705261\n5         0.12990138          -0.4196596             0.640289855 -0.12249416\n6        -0.13361179          -0.4237096            -0.005103357  1.00426206\n7        -0.33542751          -0.8235874             3.760298131 -7.31116712\n8         0.09462126          -0.2405003             0.520038994 -0.03439159\n9        -0.93339393          -0.3739225            -2.359121712 -1.67102293\n10        0.15961128           1.9461735            -0.627237944 -2.63204802\n   PROX_PARK_TV PROX_PRIMARY_SCH_TV PROX_SHOPPING_MALL_TV PROX_BUS_STOP_TV\n1   -0.83749312           1.5923022            2.75358842        2.0154464\n2    2.28192684           6.7019454           -0.88662640        4.4941192\n3    0.66565951           2.9058009           -1.05686949        3.0419145\n4   -3.34061770          12.9836105           -0.16709578       12.8383775\n5   -0.02820944           0.1220998           -0.02488294        0.9145046\n6    0.86781794           0.4696245            0.08821750        0.7656963\n7    2.38773567           5.1844351           -1.53719231        6.2029165\n8    0.16674816           0.2042469           -0.11271635        0.9493299\n9   -0.43301073          -0.1442145            0.95462153        3.3123012\n10   0.95831249           0.3290120           -1.71252687        3.3632555\n   NO_Of_UNITS_TV FAMILY_FRIENDLY_TV FREEHOLD_TV  Local_R2\n1     0.480589953        -0.06902748    2.621347 0.8846744\n2    -1.380026395         2.69655779    3.045280 0.8899773\n3    -0.045279967         0.04058290    1.197050 0.8947007\n4    -0.446007570        14.31276425    8.771149 0.9073605\n5     0.141120178         0.36714544    1.557983 0.9510057\n6    -0.355762335         0.60891234    1.260522 0.9247586\n7    -0.001731033         2.78285441    2.243875 0.8310458\n8     0.089093858         0.32346758    1.602012 0.9463936\n9     1.534793921        -0.13828365    2.285410 0.8380365\n10   -0.082251138        -0.53369623    1.033819 0.9080753\n                    geometry\n1  POINT (22085.12 29951.54)\n2   POINT (25656.84 34546.2)\n3   POINT (23963.99 32890.8)\n4  POINT (27044.28 32319.77)\n5  POINT (41042.56 33743.64)\n6   POINT (39717.04 32943.1)\n7   POINT (28419.1 33513.37)\n8  POINT (40763.57 33879.61)\n9  POINT (23595.63 28884.78)\n10 POINT (24586.56 33194.31)\n\n\n\ngwr.adaptive.output &lt;- as.data.frame(gwr.adaptive$SDF)\ncondo_resale.sf.adaptive &lt;- cbind(condo_resale.res.sf, as.matrix(gwr.adaptive.output))\n\n\nglimpse(condo_resale.sf.adaptive)\n\nRows: 1,436\nColumns: 77\n$ POSTCODE                &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472…\n$ SELLING_PRICE           &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ AREA_SQM                &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 1…\n$ AGE                     &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22,…\n$ PROX_CBD                &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783…\n$ PROX_CHILDCARE          &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543…\n$ PROX_ELDERLYCARE        &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.…\n$ PROX_URA_GROWTH_AREA    &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.4106…\n$ PROX_HAWKER_MARKET      &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969…\n$ PROX_KINDERGARTEN       &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076…\n$ PROX_MRT                &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.…\n$ PROX_PARK               &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.…\n$ PROX_PRIMARY_SCH        &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.…\n$ PROX_TOP_PRIMARY_SCH    &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.…\n$ PROX_SHOPPING_MALL      &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.…\n$ PROX_SUPERMARKET        &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.…\n$ PROX_BUS_STOP           &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340…\n$ NO_Of_UNITS             &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34…\n$ FAMILY_FRIENDLY         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ LOG_SELLING_PRICE       &lt;dbl&gt; 14.91412, 15.17135, 15.01698, 15.26243, 14.151…\n$ MLR_RES                 &lt;dbl&gt; -1489099.55, 415494.57, 194129.69, 1088992.71,…\n$ Intercept               &lt;dbl&gt; 2050011.67, 1633128.24, 3433608.17, 234358.91,…\n$ AREA_SQM.1              &lt;dbl&gt; 9561.892, 16576.853, 13091.861, 20730.601, 672…\n$ AGE.1                   &lt;dbl&gt; -9514.634, -58185.479, -26707.386, -93308.988,…\n$ PROX_CBD.1              &lt;dbl&gt; -120681.94, -149434.22, -259397.77, 2426853.66…\n$ PROX_CHILDCARE.1        &lt;dbl&gt; 319266.925, 441102.177, -120116.816, 480825.28…\n$ PROX_ELDERLYCARE.1      &lt;dbl&gt; -393417.795, 325188.741, 535855.806, 314783.72…\n$ PROX_URA_GROWTH_AREA.1  &lt;dbl&gt; -159980.203, -142290.389, -253621.206, -267929…\n$ PROX_MRT.1              &lt;dbl&gt; -299742.96, -2510522.23, -936853.28, -2039479.…\n$ PROX_PARK.1             &lt;dbl&gt; -172104.47, 523379.72, 209099.85, -759153.26, …\n$ PROX_PRIMARY_SCH.1      &lt;dbl&gt; 242668.03, 1106830.66, 571462.33, 3127477.21, …\n$ PROX_SHOPPING_MALL.1    &lt;dbl&gt; 300881.390, -87693.378, -126732.712, -29593.34…\n$ PROX_BUS_STOP.1         &lt;dbl&gt; 1210615.44, 1843587.22, 1411924.90, 7225577.51…\n$ NO_Of_UNITS.1           &lt;dbl&gt; 104.8290640, -288.3441183, -9.5532945, -161.35…\n$ FAMILY_FRIENDLY.1       &lt;dbl&gt; -9075.370, 310074.664, 5949.746, 1556178.531, …\n$ FREEHOLD.1              &lt;dbl&gt; 303955.61, 396221.27, 168821.75, 1212515.58, 3…\n$ y                       &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ yhat                    &lt;dbl&gt; 2886531.8, 3466801.5, 3616527.2, 5435481.6, 13…\n$ residual                &lt;dbl&gt; 113468.16, 413198.52, -291527.20, -1185481.63,…\n$ CV_Score                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ Stud_residual           &lt;dbl&gt; 0.38207013, 1.01433140, -0.83780678, -2.846146…\n$ Intercept_SE            &lt;dbl&gt; 516105.5, 488083.5, 963711.4, 444185.5, 211962…\n$ AREA_SQM_SE             &lt;dbl&gt; 823.2860, 825.2380, 988.2240, 617.4007, 1376.2…\n$ AGE_SE                  &lt;dbl&gt; 5889.782, 6226.916, 6510.236, 6010.511, 8180.3…\n$ PROX_CBD_SE             &lt;dbl&gt; 37411.22, 23615.06, 56103.77, 469337.41, 41064…\n$ PROX_CHILDCARE_SE       &lt;dbl&gt; 319111.1, 299705.3, 349128.5, 304965.2, 698720…\n$ PROX_ELDERLYCARE_SE     &lt;dbl&gt; 120633.34, 84546.69, 129687.07, 127150.69, 327…\n$ PROX_URA_GROWTH_AREA_SE &lt;dbl&gt; 56207.39, 76956.50, 95774.60, 470762.12, 47433…\n$ PROX_MRT_SE             &lt;dbl&gt; 185181.3, 281133.9, 275483.7, 279877.1, 363830…\n$ PROX_PARK_SE            &lt;dbl&gt; 205499.6, 229358.7, 314124.3, 227249.4, 364580…\n$ PROX_PRIMARY_SCH_SE     &lt;dbl&gt; 152400.7, 165150.7, 196662.6, 240878.9, 249087…\n$ PROX_SHOPPING_MALL_SE   &lt;dbl&gt; 109268.8, 98906.8, 119913.3, 177104.1, 301032.…\n$ PROX_BUS_STOP_SE        &lt;dbl&gt; 600668.6, 410222.1, 464156.7, 562810.8, 740922…\n$ NO_Of_UNITS_SE          &lt;dbl&gt; 218.1258, 208.9410, 210.9828, 361.7767, 299.50…\n$ FAMILY_FRIENDLY_SE      &lt;dbl&gt; 131474.73, 114989.07, 146607.22, 108726.62, 16…\n$ FREEHOLD_SE             &lt;dbl&gt; 115954.0, 130110.0, 141031.5, 138239.1, 210641…\n$ Intercept_TV            &lt;dbl&gt; 3.9720784, 3.3460017, 3.5629010, 0.5276150, 1.…\n$ AREA_SQM_TV             &lt;dbl&gt; 11.614302, 20.087361, 13.247868, 33.577223, 4.…\n$ AGE_TV                  &lt;dbl&gt; -1.6154474, -9.3441881, -4.1023685, -15.524301…\n$ PROX_CBD_TV             &lt;dbl&gt; -3.22582173, -6.32792021, -4.62353528, 5.17080…\n$ PROX_CHILDCARE_TV       &lt;dbl&gt; 1.000488185, 1.471786337, -0.344047555, 1.5766…\n$ PROX_ELDERLYCARE_TV     &lt;dbl&gt; -3.26126929, 3.84626245, 4.13191383, 2.4756745…\n$ PROX_URA_GROWTH_AREA_TV &lt;dbl&gt; -2.846248368, -1.848971738, -2.648105057, -5.6…\n$ PROX_MRT_TV             &lt;dbl&gt; -1.61864578, -8.92998600, -3.40075727, -7.2870…\n$ PROX_PARK_TV            &lt;dbl&gt; -0.83749312, 2.28192684, 0.66565951, -3.340617…\n$ PROX_PRIMARY_SCH_TV     &lt;dbl&gt; 1.59230221, 6.70194543, 2.90580089, 12.9836104…\n$ PROX_SHOPPING_MALL_TV   &lt;dbl&gt; 2.753588422, -0.886626400, -1.056869486, -0.16…\n$ PROX_BUS_STOP_TV        &lt;dbl&gt; 2.0154464, 4.4941192, 3.0419145, 12.8383775, 0…\n$ NO_Of_UNITS_TV          &lt;dbl&gt; 0.480589953, -1.380026395, -0.045279967, -0.44…\n$ FAMILY_FRIENDLY_TV      &lt;dbl&gt; -0.06902748, 2.69655779, 0.04058290, 14.312764…\n$ FREEHOLD_TV             &lt;dbl&gt; 2.6213469, 3.0452799, 1.1970499, 8.7711485, 1.…\n$ Local_R2                &lt;dbl&gt; 0.8846744, 0.8899773, 0.8947007, 0.9073605, 0.…\n$ coords.x1               &lt;dbl&gt; 22085.12, 25656.84, 23963.99, 27044.28, 41042.…\n$ coords.x2               &lt;dbl&gt; 29951.54, 34546.20, 32890.80, 32319.77, 33743.…\n$ geometry                &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n\n\n\nsummary(gwr.adaptive$SDF$yhat)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n  171347  1102001  1385528  1751842  1982307 13887901 \n\n\n\n\n3.3.5 Visualising local R2\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\n\n3.3.6 Visualising Coefficient Estimates\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nAREA_SQM_SE &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nAREA_SQM_TV &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\nWarning: The shape mpsz_svy21 is invalid. See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\n3.3.6.1 By URA Planning Region\n\ntm_shape(mpsz_svy21[mpsz_svy21$REGION_N==\"CENTRAL REGION\", ])+\n  tm_polygons()+\ntm_shape(condo_resale.sf.adaptive) + \n  tm_bubbles(col = \"Local_R2\",\n           size = 0.15,\n           border.col = \"gray60\",\n           border.lwd = 1)\n\nWarning: The shape mpsz_svy21[mpsz_svy21$REGION_N == \"CENTRAL REGION\", ] is\ninvalid. See sf::st_is_valid"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html",
    "title": "In-class Exercise 7",
    "section": "",
    "text": "pacman::p_load(olsrr, corrplot, ggpubr,\n               sf, spdep, GWmodel, tmap,\n               tidyverse, gtsummary, ggstatsplot)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#load-and-install-r-packages",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#load-and-install-r-packages",
    "title": "In-class Exercise 7",
    "section": "",
    "text": "pacman::p_load(olsrr, corrplot, ggpubr,\n               sf, spdep, GWmodel, tmap,\n               tidyverse, gtsummary, ggstatsplot)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#importing-data",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#importing-data",
    "title": "In-class Exercise 7",
    "section": "2 Importing Data",
    "text": "2 Importing Data\n\ncondo_resale &lt;- read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\ncondo_resale.sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs=4326) %&gt;%\n  st_transform(crs=3414)\n\n\nmpsz = st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\brigittatsai\\ISSS626_AY2024-25_T1\\In-class_Ex\\In-class_Ex07\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#correlation-analysis",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#correlation-analysis",
    "title": "In-class Exercise 7",
    "section": "3 Correlation Analysis",
    "text": "3 Correlation Analysis\n\nggcorrmat(condo_resale[, 5:23])"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#linear-regression-method",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#linear-regression-method",
    "title": "In-class Exercise 7",
    "section": "4 Linear Regression Method",
    "text": "4 Linear Regression Method\n\ncondo_mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM +\n                  AGE + PROX_CBD + PROX_CHILDCARE +\n                  PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA +\n                  PROX_HAWKER_MARKET + PROX_KINDERGARTEN +\n                  PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH +\n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL +\n                  PROX_SUPERMARKET + PROX_BUS_STOP +\n                  NO_Of_UNITS + FAMILY_FRIENDLY +\n                  FREEHOLD + LEASEHOLD_99YR,\n                data=condo_resale.sf)\nsummary(condo_mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD + \n    LEASEHOLD_99YR, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471036  -286903   -22426   239412 12254549 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           543071.4   136210.9   3.987 7.03e-05 ***\nAREA_SQM               12688.7      370.1  34.283  &lt; 2e-16 ***\nAGE                   -24566.0     2766.0  -8.881  &lt; 2e-16 ***\nPROX_CBD              -78122.0     6791.4 -11.503  &lt; 2e-16 ***\nPROX_CHILDCARE       -333219.0   111020.3  -3.001 0.002734 ** \nPROX_ELDERLYCARE      170950.0    42110.8   4.060 5.19e-05 ***\nPROX_URA_GROWTH_AREA   38507.6    12523.7   3.075 0.002147 ** \nPROX_HAWKER_MARKET     23801.2    29299.9   0.812 0.416739    \nPROX_KINDERGARTEN     144098.0    82738.7   1.742 0.081795 .  \nPROX_MRT             -322775.9    58528.1  -5.515 4.14e-08 ***\nPROX_PARK             564487.9    66563.0   8.481  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      186170.5    65515.2   2.842 0.004553 ** \nPROX_TOP_PRIMARY_SCH    -477.1    20598.0  -0.023 0.981525    \nPROX_SHOPPING_MALL   -207721.5    42855.5  -4.847 1.39e-06 ***\nPROX_SUPERMARKET      -48074.7    77145.3  -0.623 0.533273    \nPROX_BUS_STOP         675755.0   138552.0   4.877 1.20e-06 ***\nNO_Of_UNITS             -216.2       90.3  -2.394 0.016797 *  \nFAMILY_FRIENDLY       142128.3    47055.1   3.020 0.002569 ** \nFREEHOLD              300646.5    77296.5   3.890 0.000105 ***\nLEASEHOLD_99YR        -77137.4    77570.9  -0.994 0.320192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1416 degrees of freedom\nMultiple R-squared:  0.652, Adjusted R-squared:  0.6474 \nF-statistic: 139.6 on 19 and 1416 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#olsrr-method",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html#olsrr-method",
    "title": "In-class Exercise 7",
    "section": "5 olsrr Method",
    "text": "5 olsrr Method\n\nols_regress(condo_mlr)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     750537.537 \nR-Squared                    0.652       MSE                571262902261.223 \nAdj. R-Squared               0.647       Coef. Var                    43.160 \nPred R-Squared               0.637       AIC                       42971.173 \nMAE                     412117.987       SBC                       43081.835 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.515738e+15          19        7.977571e+13    139.648    0.0000 \nResidual      8.089083e+14        1416    571262902261.223                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     543071.420    136210.918                   3.987    0.000     275874.535     810268.305 \n            AREA_SQM      12688.669       370.119        0.579     34.283    0.000      11962.627      13414.710 \n                 AGE     -24566.001      2766.041       -0.166     -8.881    0.000     -29991.980     -19140.022 \n            PROX_CBD     -78121.985      6791.377       -0.267    -11.503    0.000     -91444.227     -64799.744 \n      PROX_CHILDCARE    -333219.036    111020.303       -0.087     -3.001    0.003    -551000.984    -115437.089 \n    PROX_ELDERLYCARE     170949.961     42110.748        0.083      4.060    0.000      88343.803     253556.120 \nPROX_URA_GROWTH_AREA      38507.622     12523.661        0.059      3.075    0.002      13940.700      63074.545 \n  PROX_HAWKER_MARKET      23801.197     29299.923        0.019      0.812    0.417     -33674.725      81277.120 \n   PROX_KINDERGARTEN     144097.972     82738.669        0.030      1.742    0.082     -18205.570     306401.514 \n            PROX_MRT    -322775.874     58528.079       -0.123     -5.515    0.000    -437586.937    -207964.811 \n           PROX_PARK     564487.876     66563.011        0.148      8.481    0.000     433915.162     695060.590 \n    PROX_PRIMARY_SCH     186170.524     65515.193        0.072      2.842    0.005      57653.253     314687.795 \nPROX_TOP_PRIMARY_SCH       -477.073     20597.972       -0.001     -0.023    0.982     -40882.894      39928.747 \n  PROX_SHOPPING_MALL    -207721.520     42855.500       -0.109     -4.847    0.000    -291788.613    -123654.427 \n    PROX_SUPERMARKET     -48074.679     77145.257       -0.012     -0.623    0.533    -199405.956     103256.599 \n       PROX_BUS_STOP     675755.044    138551.991        0.133      4.877    0.000     403965.817     947544.272 \n         NO_Of_UNITS       -216.180        90.302       -0.046     -2.394    0.017       -393.320        -39.040 \n     FAMILY_FRIENDLY     142128.272     47055.082        0.056      3.020    0.003      49823.107     234433.438 \n            FREEHOLD     300646.543     77296.529        0.117      3.890    0.000     149018.525     452274.561 \n      LEASEHOLD_99YR     -77137.375     77570.869       -0.030     -0.994    0.320    -229303.551      75028.801 \n-----------------------------------------------------------------------------------------------------------------\n\n\n\n5.1 Multicolinearity\n\nols_vif_tol(condo_mlr)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8601326 1.162611\n2                   AGE 0.7011585 1.426211\n3              PROX_CBD 0.4575471 2.185567\n4        PROX_CHILDCARE 0.2898233 3.450378\n5      PROX_ELDERLYCARE 0.5922238 1.688551\n6  PROX_URA_GROWTH_AREA 0.6614081 1.511926\n7    PROX_HAWKER_MARKET 0.4373874 2.286303\n8     PROX_KINDERGARTEN 0.8356793 1.196631\n9              PROX_MRT 0.4949877 2.020252\n10            PROX_PARK 0.8015728 1.247547\n11     PROX_PRIMARY_SCH 0.3823248 2.615577\n12 PROX_TOP_PRIMARY_SCH 0.4878620 2.049760\n13   PROX_SHOPPING_MALL 0.4903052 2.039546\n14     PROX_SUPERMARKET 0.6142127 1.628100\n15        PROX_BUS_STOP 0.3311024 3.020213\n16          NO_Of_UNITS 0.6543336 1.528272\n17      FAMILY_FRIENDLY 0.7191719 1.390488\n18             FREEHOLD 0.2728521 3.664990\n19       LEASEHOLD_99YR 0.2645988 3.779307\n\n\n\n\n5.2 Variable Selection"
  }
]